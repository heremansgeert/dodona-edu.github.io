<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Adding new programming languages | Dodona Docs</title>
    <meta name="generator" content="VuePress 1.9.7">
    <meta name="description" content="Configuring a new programming language in TESTed">
    <meta name="theme-color" content="#1976d2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.77030c83.css" as="style"><link rel="preload" href="/assets/js/app.7cfd56ff.js" as="script"><link rel="preload" href="/assets/js/3.8e0e6159.js" as="script"><link rel="preload" href="/assets/js/96.3935243d.js" as="script"><link rel="prefetch" href="/assets/js/10.d12ffa2f.js"><link rel="prefetch" href="/assets/js/100.fc454ab3.js"><link rel="prefetch" href="/assets/js/101.697002e8.js"><link rel="prefetch" href="/assets/js/102.b7fc372a.js"><link rel="prefetch" href="/assets/js/103.1326d257.js"><link rel="prefetch" href="/assets/js/104.86d8c786.js"><link rel="prefetch" href="/assets/js/105.af0aca11.js"><link rel="prefetch" href="/assets/js/106.51cc2c4e.js"><link rel="prefetch" href="/assets/js/107.3456318c.js"><link rel="prefetch" href="/assets/js/108.b9ffb652.js"><link rel="prefetch" href="/assets/js/109.0d0c6bab.js"><link rel="prefetch" href="/assets/js/11.cafe3c23.js"><link rel="prefetch" href="/assets/js/110.7d749567.js"><link rel="prefetch" href="/assets/js/111.bafd9e53.js"><link rel="prefetch" href="/assets/js/112.e996201b.js"><link rel="prefetch" href="/assets/js/113.b0ffef24.js"><link rel="prefetch" href="/assets/js/114.9d8bf8c3.js"><link rel="prefetch" href="/assets/js/115.e76b6c85.js"><link rel="prefetch" href="/assets/js/116.2065f9ac.js"><link rel="prefetch" href="/assets/js/117.91a0839d.js"><link rel="prefetch" href="/assets/js/118.2d2491ee.js"><link rel="prefetch" href="/assets/js/119.844a74dc.js"><link rel="prefetch" href="/assets/js/12.ab57a964.js"><link rel="prefetch" href="/assets/js/13.96851809.js"><link rel="prefetch" href="/assets/js/14.ffadf615.js"><link rel="prefetch" href="/assets/js/15.7874118d.js"><link rel="prefetch" href="/assets/js/16.c67994bc.js"><link rel="prefetch" href="/assets/js/17.7ab85664.js"><link rel="prefetch" href="/assets/js/18.c19198e1.js"><link rel="prefetch" href="/assets/js/19.0c7983e5.js"><link rel="prefetch" href="/assets/js/20.83de6582.js"><link rel="prefetch" href="/assets/js/21.e4a6d8fd.js"><link rel="prefetch" href="/assets/js/22.130e749b.js"><link rel="prefetch" href="/assets/js/23.70633bda.js"><link rel="prefetch" href="/assets/js/24.6013b426.js"><link rel="prefetch" href="/assets/js/25.534a5666.js"><link rel="prefetch" href="/assets/js/26.45e3534c.js"><link rel="prefetch" href="/assets/js/27.892f368f.js"><link rel="prefetch" href="/assets/js/28.bfa1aa9f.js"><link rel="prefetch" href="/assets/js/29.cb777ec7.js"><link rel="prefetch" href="/assets/js/30.bd05d1dc.js"><link rel="prefetch" href="/assets/js/31.c9eac528.js"><link rel="prefetch" href="/assets/js/32.8e31a0da.js"><link rel="prefetch" href="/assets/js/33.87504975.js"><link rel="prefetch" href="/assets/js/34.dad781ce.js"><link rel="prefetch" href="/assets/js/35.f01c08ab.js"><link rel="prefetch" href="/assets/js/36.8601fd60.js"><link rel="prefetch" href="/assets/js/37.e7030153.js"><link rel="prefetch" href="/assets/js/38.7a389e14.js"><link rel="prefetch" href="/assets/js/39.d2c5a0ff.js"><link rel="prefetch" href="/assets/js/4.ea7ed0b9.js"><link rel="prefetch" href="/assets/js/40.9fab4edf.js"><link rel="prefetch" href="/assets/js/41.1934cbce.js"><link rel="prefetch" href="/assets/js/42.dca96bb8.js"><link rel="prefetch" href="/assets/js/43.e976e396.js"><link rel="prefetch" href="/assets/js/44.660cc893.js"><link rel="prefetch" href="/assets/js/45.bcd381ff.js"><link rel="prefetch" href="/assets/js/46.e76cae36.js"><link rel="prefetch" href="/assets/js/47.057e75de.js"><link rel="prefetch" href="/assets/js/48.1de85714.js"><link rel="prefetch" href="/assets/js/49.58484939.js"><link rel="prefetch" href="/assets/js/5.b3fb398b.js"><link rel="prefetch" href="/assets/js/50.e38ddc57.js"><link rel="prefetch" href="/assets/js/51.faf9a01b.js"><link rel="prefetch" href="/assets/js/52.1da6e8c7.js"><link rel="prefetch" href="/assets/js/53.592e950a.js"><link rel="prefetch" href="/assets/js/54.63568203.js"><link rel="prefetch" href="/assets/js/55.263f705b.js"><link rel="prefetch" href="/assets/js/56.d7201331.js"><link rel="prefetch" href="/assets/js/57.8f4eb1bf.js"><link rel="prefetch" href="/assets/js/58.4c430f83.js"><link rel="prefetch" href="/assets/js/59.47b493a8.js"><link rel="prefetch" href="/assets/js/6.0ca19ec4.js"><link rel="prefetch" href="/assets/js/60.ea9fa268.js"><link rel="prefetch" href="/assets/js/61.39019f18.js"><link rel="prefetch" href="/assets/js/62.b0c696d7.js"><link rel="prefetch" href="/assets/js/63.79db35f2.js"><link rel="prefetch" href="/assets/js/64.530f7404.js"><link rel="prefetch" href="/assets/js/65.c05429ab.js"><link rel="prefetch" href="/assets/js/66.dac0d035.js"><link rel="prefetch" href="/assets/js/67.82e44520.js"><link rel="prefetch" href="/assets/js/68.28681e21.js"><link rel="prefetch" href="/assets/js/69.a3b69284.js"><link rel="prefetch" href="/assets/js/7.4ca20bd5.js"><link rel="prefetch" href="/assets/js/70.627c74b6.js"><link rel="prefetch" href="/assets/js/71.16acdff7.js"><link rel="prefetch" href="/assets/js/72.d2719d52.js"><link rel="prefetch" href="/assets/js/73.f49bb2fc.js"><link rel="prefetch" href="/assets/js/74.69b0b449.js"><link rel="prefetch" href="/assets/js/75.94d94ec4.js"><link rel="prefetch" href="/assets/js/76.e1643408.js"><link rel="prefetch" href="/assets/js/77.933177ae.js"><link rel="prefetch" href="/assets/js/78.985dfbe1.js"><link rel="prefetch" href="/assets/js/79.0f5f0cca.js"><link rel="prefetch" href="/assets/js/8.411ef121.js"><link rel="prefetch" href="/assets/js/80.ae842956.js"><link rel="prefetch" href="/assets/js/81.bb6a4cd8.js"><link rel="prefetch" href="/assets/js/82.7649f46b.js"><link rel="prefetch" href="/assets/js/83.5d83bd30.js"><link rel="prefetch" href="/assets/js/84.d87b3071.js"><link rel="prefetch" href="/assets/js/85.98b8b3f9.js"><link rel="prefetch" href="/assets/js/86.82d4fbab.js"><link rel="prefetch" href="/assets/js/87.fdde35fc.js"><link rel="prefetch" href="/assets/js/88.4fac20fa.js"><link rel="prefetch" href="/assets/js/89.5046834d.js"><link rel="prefetch" href="/assets/js/9.3f3862f9.js"><link rel="prefetch" href="/assets/js/90.162ddfbd.js"><link rel="prefetch" href="/assets/js/91.c7ec1218.js"><link rel="prefetch" href="/assets/js/92.b6eb072f.js"><link rel="prefetch" href="/assets/js/93.f6b9ad8f.js"><link rel="prefetch" href="/assets/js/94.d655dc54.js"><link rel="prefetch" href="/assets/js/95.d03186cd.js"><link rel="prefetch" href="/assets/js/97.0c274bc6.js"><link rel="prefetch" href="/assets/js/98.027c3468.js"><link rel="prefetch" href="/assets/js/99.1095ce6b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.25429ca7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.77030c83.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">Dodona Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/news/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/en/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/en/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/en/tested/" class="nav-link router-link-active">
  TESTed
</a></div><div class="nav-item"><a href="https://dodona.ugent.be" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dodona
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">🌐</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">🌐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nl/tested/new-programming-language/" class="nav-link">
  Nederlands
</a></li><li class="dropdown-item"><!----> <a href="/en/tested/new-programming-language/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/news/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/en/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/en/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/en/tested/" class="nav-link router-link-active">
  TESTed
</a></div><div class="nav-item"><a href="https://dodona.ugent.be" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dodona
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">🌐</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">🌐</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nl/tested/new-programming-language/" class="nav-link">
  Nederlands
</a></li><li class="dropdown-item"><!----> <a href="/en/tested/new-programming-language/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/en/news/" class="sidebar-link">News</a></li><li><a href="/en/guides/" class="sidebar-link">Guides</a></li><li><a href="/en/references/" class="sidebar-link">References</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TESTed judge</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/tested/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/en/tested/exercise-config/" class="sidebar-link">Exercise configuration options</a></li><li><a href="/en/tested/json/" class="sidebar-link">Test suite format</a></li><li><a href="/en/tested/types/" class="sidebar-link">Data type support</a></li><li><a href="/en/tested/new-programming-language/" aria-current="page" class="active sidebar-link">Adding new programming languages</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#installing-and-running-tested" class="sidebar-link">Installing and running TESTed</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#design-choices" class="sidebar-link">Design choices</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#the-c-programming-language" class="sidebar-link">The C programming language</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#configuration-file" class="sidebar-link">Configuration file</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#language-specific-names-for-data-types" class="sidebar-link">Language-specific names for data types</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#configuration-class" class="sidebar-link">Configuration class</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#templates" class="sidebar-link">Templates</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#register-the-language" class="sidebar-link">Register the language</a></li><li class="sidebar-sub-header"><a href="/en/tested/new-programming-language/#testing-the-language-implementation" class="sidebar-link">Testing the language implementation</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="adding-new-programming-languages"><a href="#adding-new-programming-languages" class="header-anchor">#</a> Adding new programming languages</h1> <p>TESTed is extensible with new programming languages.
It is designed around a common core,
that implements the bulk of the functionality required by a software test framework in a generic way.
This core calls an internal API whenever it needs functionality that depends on a specific programming language.
All programming languages supported by TESTed have a language module that implements this internal API.</p> <p>This tutorial explains in detail how a language module can implement the internal API for a new programming language,
essentially extending TESTed with support for the new programming language.
We will use the C programming language as an example
but indicate explicitly where we make configurations that are specific for the C programming language.
As such, you can follow this tutorial to extend TESTed with support for other programming languages.</p> <p>Some useful links that can help you:</p> <ul><li>Implementations of modules for all programming languages currently supported by TESTed, including the C module that is
used as an example in this tutorial: <a href="https://github.com/dodona-edu/universal-judge/tree/master/tested/languages" target="_blank" rel="noopener noreferrer">https://github.com/dodona-edu/universal-judge/tree/master/tested/languages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Test exercises: <a href="https://github.com/dodona-edu/universal-judge/tree/master/exercise" target="_blank" rel="noopener noreferrer">https://github.com/dodona-edu/universal-judge/tree/master/exercise<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="installing-and-running-tested"><a href="#installing-and-running-tested" class="header-anchor">#</a> Installing and running TESTed</h2> <p>Because support for programming languages is added to TESTed itself,
running and testing TESTed will be essential during development of language modules.
You therefore need to install TESTed locally.
We recommend following the instructions from
the <a href="https://github.com/dodona-edu/universal-judge#installing-tested" target="_blank" rel="noopener noreferrer">README<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in the GitHub repository of TESTed.
Note that you only need to install the Python dependencies.
Dependencies for other programming languages (e.g. <code>ghc</code> for Haskell) are optional.</p> <p>To follow the parts of this tutorial that focus on the C programming language,
you also need to have a local installation of the <code>gcc</code> compiler (version 8.1 or up).</p> <div class="custom-block tip"><p class="custom-block-title">Windows users</p> <p>We recommend using the <a href="https://learn.microsoft.com/en-us/windows/wsl/" target="_blank" rel="noopener noreferrer">Windows Subsystem for Linux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for development on Windows machines.
While TESTed is itself written in Python and thus platform independent,
dependencies for programming languages are not always available on Windows for each language.</p></div> <h3 id="running-tested"><a href="#running-tested" class="header-anchor">#</a> Running TESTed</h3> <p>After cloning the GitHub repository of TESTed and installing the necessary dependencies,
the directory in which TESTed is installed should look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>universal-judge
├── exercise/     # Test exercises
├── tested/       # Sources
├── tests/        # Tests
├── workdir/      # Working directory when manually running TESTed
├── config.json   # Used in Dodona
└── run           # Used in Dodona
</code></pre></div><p>In this tutorial, we assume you run the commands in the root directory of the repository.
Test if you can run TESTed using the following command:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python <span class="token parameter variable">-m</span> tested <span class="token parameter variable">--help</span>
usage: __main__.py <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-c CONFIG<span class="token punctuation">]</span> <span class="token punctuation">[</span>-o OUTPUT<span class="token punctuation">]</span> <span class="token punctuation">[</span>-v<span class="token punctuation">]</span>
The programming language agnostic educational <span class="token builtin class-name">test</span> framework.
optional arguments:
  -h, <span class="token parameter variable">--help</span>            show this <span class="token builtin class-name">help</span> message and <span class="token builtin class-name">exit</span>
  <span class="token parameter variable">-c</span> CONFIG, <span class="token parameter variable">--config</span> CONFIG
                        Where to <span class="token builtin class-name">read</span> the config from
  <span class="token parameter variable">-o</span> OUTPUT, <span class="token parameter variable">--output</span> OUTPUT
                        Where the judge output should be written to.
  -v, <span class="token parameter variable">--verbose</span>         Include verbose logs. It is recommended to also use <span class="token parameter variable">-o</span> <span class="token keyword">in</span> this case.
</code></pre></div><p>The above command is how you run TESTed in production.
For development, however, the need to always specify an exercise configuration is somewhat cumbersome.
For that purpose, you can run TESTed in development mode which uses a hard-coded configuration:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python <span class="token parameter variable">-m</span> tested.manual
</code></pre></div><p>Running TESTed in development mode uses the hard-coded values defined in <code>tested/manual.py</code> to evaluate an exercise
and puts all files that are generated intermediately into the <code>workdir</code> directory of TESTed.
The latter can be very useful, for example, to inspect the test code that is generated by a language module.
If the <code>workdir</code> directory does not exist yet, you might need to create it.</p> <h2 id="design-choices"><a href="#design-choices" class="header-anchor">#</a> Design choices</h2> <p>Extending TESTed with support for a new programming language comes down
to implementing the internal API in a language module for that programming language.
In theory, implementing such a language module is nothing more than creating one subclass.
But we recommend the following structure:</p> <ol><li>A configuration file that contains some specific options for the programming language.
This also includes the type configuration, which specifies the data type support for the programming language.</li> <li>A configuration class that has some more dynamic options, such as the compilation command used when evaluating
submissions.</li> <li>Templates that are used to generate test code.</li></ol> <p>TESTed contains a utility that generates stubs for these files in the correct location.
Based on your answers to a few questions, stubs will be generated for a configuration file, a configuration class and
the templates. Run the utility using the following command:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python <span class="token parameter variable">-m</span> tested.generation
</code></pre></div><p>Note that this command will only generate stub files for a new programming language.
It will not modify core TESTed files, so you should not forget to register the new language in TESTed later
(see <a href="#register-the-language"><em>Registration</em></a>).</p> <p>We will now look at the steps you need to take to add support for the C programming language to TESTed.
We assume the generation tool was not used, so in each step we will manually create the files.
If you did use the generation tool, skip the parts where the files are created.</p> <h2 id="the-c-programming-language"><a href="#the-c-programming-language" class="header-anchor">#</a> The C programming language</h2> <p>Before starting to add support for C, we first look briefly into what features of C we want to support:
what language features can we support in TESTed and what TESTed features can we support in C?</p> <p>Of course, we want to support as much of the TESTed features as possible.
However, there are some limitations, especially in regard to data type support.</p> <h3 id="unsupported-basic-types"><a href="#unsupported-basic-types" class="header-anchor">#</a> Unsupported basic types</h3> <p>In the C language module, we will not support the following basic types:</p> <ul><li><code>sequence</code>:
Arrays in C are special, compared to other programming languages.
Static arrays cannot be used as a return value, and are not ideal as function parameters either.
On the other hand, effectively using a dynamic array requires a pointer to the data and the size of the array.
This has implications: for example, you need to pass two parameters if you want to pass an array to a function.
TESTed currently has no support to pass literal values through multiple parameters,
so sequences are currently not supported for the C programming language.
Arrays as return values could be possible by using a struct that wraps the pointer and its size.
However, this is non-standard and thus not supported at the moment.</li> <li><code>set</code>: C does not have built-in sets.</li> <li><code>map</code>: C does not have built-in maps.
C has structs, but it is not possible to get access to their field names at runtime,
so there is no way to serialize them.</li></ul> <h3 id="unsupported-advanced-types"><a href="#unsupported-advanced-types" class="header-anchor">#</a> Unsupported advanced types</h3> <p>Obviously, the C language module will not support any advanced type that has an unsupported basic type.
In addition, the C language module will also not support the following advanced types:</p> <ul><li><code>bigint</code>: C does not have built-in arbitrary precision integers.</li> <li><code>fixed_precision</code>: C does not have built-in fixed precision real numbers.</li></ul> <p>The first step is to create a directory for the configuration code of the C language module.
This directory must be named after the programming language
and created as a subdirectory of the <code>tested/languages</code> directory.
Create a new directory <code>tested/languages/c</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>universal-judge/
├─ tested/
│ ├─ languages/
│ │ ├── c/        &lt;- new folder
│ │ ├── haskell/
│ │ ├── java/
│ │ ├── python/
│ │ ├── config.py
│ │ ...
│ ...
...
</code></pre></div><h2 id="configuration-file"><a href="#configuration-file" class="header-anchor">#</a> Configuration file</h2> <p>A configuration file for a programming language in TESTed is a JSON file
configuring some static properties of the language.
Technically, this file is optional: you only need to implement the configuration class,
which we will do in <a href="#configuration-class"><em>Configuration class</em></a>.
However, using a configuration file makes the implementation of the configuration class much easier.
Create a configuration file <code>tested/languages/c/config.json</code> (however, you probably want to remove the comments, as
those are not support by JSON):</p> <div class="language-json5 extra-class"><pre class="language-json5"><code><span class="token punctuation">{</span>
 <span class="token comment">// General options about the language.</span>
 <span class="token property">&quot;general&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// Files which will be available in the compilation and execution step.</span>
  <span class="token comment">// We'll discuss these later, but these are dependencies that are needed</span>
  <span class="token comment">// during the compilation step in C.</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
   <span class="token string">&quot;values.h&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;values.c&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;evaluation_result.h&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;evaluation_result.c&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// If the language uses a selector during compilation.</span>
  <span class="token comment">// This is true for most languages, including C.  </span>
  <span class="token property">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token property">&quot;extensions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// Extension of the generated test code.  </span>
  <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// Extensions of the templates.</span>
  <span class="token comment">// Defaults to the file extension and mako.</span>
  <span class="token property">&quot;templates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
   <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;mako&quot;</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// The default value, so not really necessary.</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">// Language constructs are translated into the style of the programming language</span>
 <span class="token property">&quot;naming_conventions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// Possibilities are snake_case, camelCase and PascalCase</span>
  <span class="token property">&quot;namespace&quot;</span><span class="token operator">:</span> <span class="token string">&quot;snake_case&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// snake_case is the default</span>
  <span class="token property">&quot;function&quot;</span><span class="token operator">:</span> <span class="token string">&quot;snake_case&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">// Indicate for which language constructs recognized by TESTed</span>
 <span class="token comment">// we want to add support.</span>
 <span class="token comment">// By default, all constructs are false, meaning no support.</span>
 <span class="token property">&quot;constructs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// Object-oriented stuff, such as classes and constructors.</span>
  <span class="token property">&quot;objects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// Throwable exceptions.</span>
  <span class="token property">&quot;exceptions&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// Functions</span>
  <span class="token property">&quot;function_calls&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// Assignments (often a variable)</span>
  <span class="token comment">// However, e.g. in Haskell this is implemented as a constant function</span>
  <span class="token comment">// returning the same value. So, it is a &quot;conceptual&quot; assignment, not</span>
  <span class="token comment">// necessarily a real one.</span>
  <span class="token comment">// For example, `x = 5` is technically a function in Haskell, but is</span>
  <span class="token comment">// considered an assignment in TESTed.</span>
  <span class="token property">&quot;assignments&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// If collections (e.g. lists) can have elements of different types.</span>
  <span class="token comment">// For example, there is support in Python; it is difficult </span>
  <span class="token comment">// in Java and Haskell does not support it at all.</span>
  <span class="token property">&quot;heterogeneous_collections&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// If a function can accept arguments of different types.</span>
  <span class="token comment">// For example, Java supports this with method overloading.</span>
  <span class="token comment">// On the other hand, C does not support this.</span>
  <span class="token comment">// An example is `echo(&quot;string&quot;)` and `echo(5)`.</span>
  <span class="token property">&quot;heterogeneous_arguments&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// If programmed checks are supported in this language.</span>
  <span class="token comment">// Technically, not a language construct.</span>
  <span class="token property">&quot;evaluation&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// If named function arguments are supported.</span>
  <span class="token comment">// This implies the arguments can be passed in a different order.</span>
  <span class="token comment">// For example, Python supports this.</span>
  <span class="token property">&quot;named_arguments&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// If default values for function arguments are supported.</span>
  <span class="token property">&quot;default_parameters&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">// Indicate which datatypes are supported in this language.</span>
 <span class="token comment">// By default, all basic types are supported, but advanced types are not.</span>
 <span class="token comment">// There are three possible values:</span>
 <span class="token comment">// - supported: full support</span>
 <span class="token comment">// - unsupported: no support</span>
 <span class="token comment">// - reduced: only for advanced types. This indicates that the type will</span>
 <span class="token comment">//   be reduced to its basic type. E.g. a list will become a sequence.</span>
 <span class="token property">&quot;datatypes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// BASIC TYPES</span>
  <span class="token property">&quot;integer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;rational&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;char&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;boolean&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sequence&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// ADVANCED TYPES</span>
  <span class="token property">&quot;set&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;map&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;nothing&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bigint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;single_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;double_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;double_extended&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fixed_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;array&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;list&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tuple&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">// Indicate limits on data structures.</span>
 <span class="token comment">// For example, some languages have limits on the possible types for keys</span>
 <span class="token comment">// in map-like data structures.</span>
 <span class="token comment">// For example, maps are implemented using Objects in JavaScript, which means</span>
 <span class="token comment">// that not all types are usable as keys.</span>
 <span class="token comment">// This is an advanced configuration. We recommend leaving it until later.</span>
 <span class="token comment">// For C, the list is empty, since C does not support either data structure.</span>
 <span class="token property">&quot;restrictions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;map_key&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;set&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="language-specific-names-for-data-types"><a href="#language-specific-names-for-data-types" class="header-anchor">#</a> Language-specific names for data types</h2> <div class="custom-block warning"><p class="custom-block-title">Experimental</p> <p>Currently,
configuration of language-specific names for data types is an experimental feature of TESTed and thus optional.</p></div> <p>TESTed supports describing problem statements in a generic way,
using a templating system
in which placeholders will be replaced by text that depends on a specific programming language.
One aspect of this process is
that the same data type might be known under different names in different programming languages.
For this purpose, create a type configuration file <code>tested/languages/c/types.json</code>.
See the different files for the different programming languages for examples.
Note that this feature of TESTed is still experimental, so future changes are possible.</p> <h2 id="configuration-class"><a href="#configuration-class" class="header-anchor">#</a> Configuration class</h2> <p>A configuration class is the only mandatory part of extending TESTed with support for a programming language.
It implements the internal API that TESTed uses as an interface between the core module and a language module.
Because the core module of TESTed is implemented in Python,
a configuration class needs to be implemented in Python as well.</p> <p>Create a Python module <code>tested/languages/c/config.py</code> and define a class that inherits from <code>Language</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>Language<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># See the docs of the parent class for all available options.</span>
    <span class="token comment"># Most of the default implementations fall back to using the JSON</span>
    <span class="token comment"># configuration file, but you could also override them all and not</span>
    <span class="token comment"># use the configuration file.</span>
    <span class="token comment"># The compilation command used by TESTed.</span>
    <span class="token comment"># See below for more information, or check the method documentation</span>
    <span class="token comment"># for technical details.</span>
    <span class="token keyword">def</span> <span class="token function">compilation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Config<span class="token punctuation">,</span> files<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> CallbackResult<span class="token punctuation">:</span>
        main_file <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        exec_file <span class="token operator">=</span> Path<span class="token punctuation">(</span>main_file<span class="token punctuation">)</span><span class="token punctuation">.</span>stem
        result <span class="token operator">=</span> executable_name<span class="token punctuation">(</span>exec_file<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;gcc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-std=c11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-Wall&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;evaluation_result.c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;values.c&quot;</span><span class="token punctuation">,</span>
                 main_file<span class="token punctuation">,</span> <span class="token string">&quot;-o&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># Execution command used by TESTed.</span>
    <span class="token comment"># This will execute the result of the compilation command.</span>
    <span class="token comment"># See below for more information, or check the method documentation</span>
    <span class="token comment"># for technical details.</span>
    <span class="token keyword">def</span> <span class="token function">execution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Config<span class="token punctuation">,</span>
                  cwd<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> arguments<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Command<span class="token punctuation">:</span>
        local_file <span class="token operator">=</span> cwd <span class="token operator">/</span> executable_name<span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">.</span>stem<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>local_file<span class="token punctuation">.</span>absolute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span>arguments<span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">solution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> solution<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> bundle<span class="token punctuation">:</span> Bundle<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Contains some code to change the main function.</span>
        <span class="token comment"># See the actual implementation for the details.</span>
        <span class="token keyword">pass</span>
</code></pre></div><h3 id="compilation"><a href="#compilation" class="header-anchor">#</a> Compilation</h3> <div class="custom-block tip"><p class="custom-block-title">Interpreted languages</p> <p>Whenever possible, we recommend adding a compilation step even for languages that are interpreted and not compiled.
For example, the compilation steps for Python and JavaScript check that submissions have no syntax errors.
However, if the programming language does not support relevant static code analysis prior to execution (e.g. Bash),
you can skip this part of the configuration class.
The default implementation skips the compilation step.</p></div> <p>The first parameter of the <code>compilation</code> method takes a class with some configuration options,
including all <a href="/en/tested/exercise-config">exercise options</a>.
For example, you could allow the exercise designer to choose what C version is used by TESTed (e.g. C99 instead of C11).
However, the current implementation of the C language module only supports C11.</p> <p>The second parameter of the <code>compilation</code> method takes a list of files that TESTed deems useful to have during
compilation,
including all dependencies specified in the configuration file,
the submission and files containing the generated test code.
By convention, the last file in the list contains the <code>main</code> function and should thus be the file being compiled.
All files will be in the same directory as the main file.
The compilation method does not need to use all files.
In case of the C programming language, for example, <code>gcc</code> takes care of loading all other files,
so we only use the main file.
As is done in the C language module,
you can also hardcode the names of files defined as dependencies in the configuration file.</p> <p>The compilation method must return a tuple with two elements: i) the compilation command and ii) the resulting files or
file filter.
TESTed uses the Python module <code>subprocess</code> to execute the compilation command.
The resulting list of files or file filter is used to copy the compiled executable to the execution directory.
Only the compiled executable will be available during execution.</p> <p>You can return a list of files if the compilation process results in executable files with predictable names.
For example, in C we know the name of the resulting binary, so we just return a list containing that name.
When returning a list of files, you should also follow the convention that the main file is at the end of the list.</p> <p>However, it is not always possible to predict the list of executables.
In Java, for example, compiling a <code>.java</code> file will result in one or more <code>.class</code> files,
depending on the content of the <code>.java</code> file.
In that case, you can return a filter function that determines what executable files must be copied.
After compilation, TESTed will call the filter function for each file in the compilation directory.</p> <p>Here's an example of calling the compilation method with the arguments and return values for C (on Windows):</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> compilation<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'submission.c'</span><span class="token punctuation">,</span> <span class="token string">'evaluation_result.c'</span><span class="token punctuation">,</span> <span class="token string">'context_0_0.c'</span><span class="token punctuation">,</span> <span class="token string">'selector.c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">'gcc'</span><span class="token punctuation">,</span> <span class="token string">'-std=c11'</span><span class="token punctuation">,</span> <span class="token string">'-Wall'</span><span class="token punctuation">,</span> <span class="token string">'evaluation_result.c'</span><span class="token punctuation">,</span> <span class="token string">'values.c'</span><span class="token punctuation">,</span> <span class="token string">'selector.c'</span><span class="token punctuation">,</span>
     <span class="token string">'-o'</span><span class="token punctuation">,</span> <span class="token string">'selector.exe'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'selector.exe'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Return an empty list as the compilation command to skip compilation.</p> <h3 id="execution"><a href="#execution" class="header-anchor">#</a> Execution</h3> <p>After compiling the submission and the test code,
TESTed must execute the test code to get the results that must be evaluated.
This is done by calling the <code>execution</code> method, which has four parameters:</p> <ul><li><code>config</code>: Same purpose as the first parameter of the <code>compilation</code> method.
For example, the Java implementation uses this parameter to set the maximum JVM memory.</li> <li><code>cwd</code>: Path name of the directory in which execution is taking place.</li> <li><code>file</code>: Name of the file that must be executed.</li> <li><code>arguments</code>: Arguments passed to the execution process. These are used, for example, to select what context TESTed must execute.</li></ul> <p>The <code>execution</code> method must return the execution command.
TESTed again uses the Python module <code>subprocess</code> to execute the execution command.
For the C programming language, TESTed simply executes the executable file with the given arguments. Here's an example of calling the execution method with the arguments and return values for C (on Windows):</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> execution<span class="token punctuation">(</span><span class="token string">'/test/path'</span><span class="token punctuation">,</span> <span class="token string">'executable.exe'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'/test/path/executable.exe'</span><span class="token punctuation">,</span> <span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span>
</code></pre></div><p>For most languages, this ends the configuration process.
However, the C programming language has the restriction that executables can only have a single <code>main</code> function.
This gives a possible conflict because the submission can have a <code>main</code> function and the generated test code also has a <code>main</code> function.
To resolve this conflict, we can use the submission method to modify the code of the submission by renaming the main function.
See the <a href="https://github.com/dodona-edu/universal-judge/blob/2cd131a5f34de93d6a68d4234fb0b595f28285d9/tested/languages/c/config.py#L87" target="_blank" rel="noopener noreferrer">actual implementation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on GitHub.</p> <h2 id="templates"><a href="#templates" class="header-anchor">#</a> Templates</h2> <p>As a last step, we need to implement some templates TESTed will use to generate test code and to translate the test suite into the programming language of the submission.</p> <p>Some templates are somewhat mandatory because they are used by the default implementation of the configuration class,
but it is often useful to create a few more templates to enable reuse.
For the C language module, we create the following templates:</p> <ul><li><code>run.c</code>: template to execute multiple contexts together (<strong>mandatory</strong>)</li> <li><code>selector.c</code>: template to select what context to execute when using batch compilation (mandatory if batch compilation is supported) (<strong>mandatory</strong> if batch compilation is supported)</li> <li><code>declaration.mako</code>: translates a variable declaration to C</li> <li><code>function.mako</code>: translates a function call to C</li> <li><code>statement.mako</code>: translates a TESTed statement (including expressions) to C (<strong>mandatory</strong>)</li> <li><code>value.mako</code>: translates a literal value to C; makes use of two helper templates: <code>value_arguments.mako</code> and <code>value_basic.mako</code></li></ul> <p>All templates are located in <code>tested/languages/c/templates</code>.</p> <h3 id="run-template"><a href="#run-template" class="header-anchor">#</a> Run template</h3> <p>The run template is conceptually the most complex template.
It is responsible for generating the test code for a single run.</p> <div class="custom-block tip"><p class="custom-block-title">Runs in TESTed</p> <p>Conceptually, TESTed will execute test code for each individual context to make sure that contexts are evaluated in isolation.
However, this means launching a new execution process for each individual context, which may introduce a lot of overhead.
As such, TESTed may combine multiple contexts in a single run, essentially executing all these contexts in a single process.
In that case, care should be taken that successive contexts do not interfere with each other.</p></div> <div class="custom-block tip"><p class="custom-block-title">White space in Mako</p> <p>TESTed uses the Mako templating system for its templates.
The default configuration of Mako in TESTed will strip Mako-induced white space.
For example, the <code>for</code>-loop below will not be indented in the test code:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> <span class="token keyword">for</span> name in evaluator_names<span class="token operator">:</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${name}.c&quot;</span></span>
<span class="token operator">%</span> endfor
</code></pre></div><p>Will result in</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;name1.c&quot;</span></span>
</code></pre></div><p>Newlines in a template file will result in newlines in the test code.
This can be suppressed by using a backslash to escape the newline:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> test <span class="token operator">=</span> \⏎
<span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>⏎
</code></pre></div><p>Will result in:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> test <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>⏎
</code></pre></div></div> <p>Here's the annotated implementation of the run template in the C language module:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token comment">// Include the values module, responsible for serialisation.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;values.h&quot;</span></span>
<span class="token comment">// Include the submission code.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${submission_name}.c&quot;</span></span>
<span class="token comment">// Import all programming language-specific checks.</span>
<span class="token operator">%</span> <span class="token keyword">for</span> name in evaluator_names<span class="token operator">:</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${name}.c&quot;</span></span>
<span class="token operator">%</span> endfor
<span class="token comment">// Create the variables which will contain the names of the files used to</span>
<span class="token comment">// save the return values and the exceptions.</span>
<span class="token comment">// C doesn't support exceptions, but TESTed still requires the file to be present.</span>
<span class="token comment">// We also define two functions to write a separator to the file.</span>
<span class="token comment">// These will be used between each context and each test case,</span>
<span class="token comment">// allowing TESTed to separate the results in the output files.</span>
<span class="token keyword">static</span> FILE<span class="token operator">*</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> FILE<span class="token operator">*</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ... continues in the next code block</span>
</code></pre></div><p>If a function or method call returns a value, TESTed must serialize the value before writing it to an output file.
This serialization converts the representation of the value in a programming language into the language-independent format used by TESTed.
It is useful to implement data serialization as a separate module, which is called &quot;values&quot; by convention.
TESTed expects an implementation of the following functions:</p> <ul><li><code>send_value(value)</code>: Serializes and writes a value to the return output file.</li> <li><code>send_exception(exception)</code>: Serializes and writes an exception to the exception output file.</li> <li><code>send_specific_value(value)</code>: Serializes and writes the result of a check for a specific programming language to the return channel.</li> <li><code>send_specific_exception(exception)</code>: Serializes and writes the result of a check for a specific programming language to the exception channel.</li></ul> <p>As the C programming language does not support exceptions, we implement the two exception functions. The two return functions are implemented using a macro:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">// ... continuation of the previous code block</span>
<span class="token comment">// Uses the function from the values module.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">send_value</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">send_value</span><span class="token expression"><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token function">write_value</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">send_specific_value</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">send_specific_value</span><span class="token expression"><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token function">write_evaluated</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span></span>
<span class="token comment">// ... continues in the next code block</span>
</code></pre></div><p>Finally, we execute the contexts by generating test code that defines one function per context:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">// ... continuation of the previous code block</span>
<span class="token comment">// Generate a function for each context in this run:</span>
<span class="token operator">%</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> ctx in <span class="token function">enumerate</span><span class="token punctuation">(</span>contexts<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_context_$<span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Optional code fragment before executing a context.</span>
        $<span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>before<span class="token punctuation">}</span>
        <span class="token comment">// Execute each test case.</span>
        <span class="token operator">%</span> <span class="token keyword">for</span> testcase in ctx<span class="token punctuation">.</span>testcases<span class="token operator">:</span>
            <span class="token comment">// Write the separator to the output files.</span>
            $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Use another template to generate the statement that must be executed.</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;statement.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;statement=testcase.input_statement()&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
        <span class="token operator">%</span> endfor
        <span class="token comment">// Optional code fragment after executing a context.</span>
        $<span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>after<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">%</span> endfor
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> continued after the text block
</code></pre></div><p>Now, we must still generate the test code that will call these context functions:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">// Generate a function that will execute the run.</span>
<span class="token keyword">int</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create the output files.</span>
    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;${value_file}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;${exception_file}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Similarly to the separator for test cases, we write the context</span>
    <span class="token comment">// separator between each execution of a context.</span>
    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// This is a special test case: it is used when you want to test</span>
    <span class="token comment">// the main function of the submission.</span>
    <span class="token operator">%</span> <span class="token keyword">if</span> run_testcase<span class="token punctuation">.</span>exists<span class="token operator">:</span>
        <span class="token keyword">char</span><span class="token operator">*</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\
        <span class="token operator">%</span> <span class="token keyword">for</span> argument in <span class="token punctuation">[</span><span class="token string">&quot;solution&quot;</span><span class="token punctuation">]</span> <span class="token operator">+</span> run_testcase<span class="token punctuation">.</span>arguments<span class="token operator">:</span>
            <span class="token string">&quot;${argument}&quot;</span><span class="token punctuation">,</span> \
        <span class="token operator">%</span> endfor
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> exit_code <span class="token operator">=</span> <span class="token function">solution_main</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span><span class="token function">len</span><span class="token punctuation">(</span>run_testcase<span class="token punctuation">.</span>arguments<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>exit_code <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> exit_code<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token operator">%</span> endif
    <span class="token comment">// Execute all contexts from the test suite.</span>
    <span class="token operator">%</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> ctx in <span class="token function">enumerate</span><span class="token punctuation">(</span>contexts<span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token comment">// Don't forget the separator.</span>
        $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Call the function we generated previously.</span>
        $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_context_$<span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span> endfor
    <span class="token comment">// We are done, so close the result files.</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// TESTed also supports batch compilation, in which case</span>
<span class="token comment">// we don't need a main function. Otherwise we do.</span>
<span class="token comment">// In batch compilation the main is not needed, since this</span>
<span class="token comment">// module will be called from the selector module.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">INCLUDED</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre></div><h3 id="selector-template"><a href="#selector-template" class="header-anchor">#</a> Selector template</h3> <p>In batch compilation, TESTed uses the selector template to select what context is executed.
We set <code>INCLUDED</code> to <code>true</code>, as this will allow us to include the above run template:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INCLUDED</span> <span class="token expression">true</span></span>
<span class="token operator">%</span> <span class="token keyword">for</span> cont in contexts<span class="token operator">:</span>
    <span class="token comment">// Include individual context files.</span>
    <span class="token comment">// This is the same code as in the file before.</span>
    <span class="token comment">// We will probably merge these in the future.</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${cont}.c&quot;</span></span>
<span class="token operator">%</span> endfor
<span class="token comment">// Main function.</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;No run context selected.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Code to execute the correct context.</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">%</span> <span class="token keyword">for</span> cont in contexts<span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token string">&quot;${cont}&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> $<span class="token punctuation">{</span>cont<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token operator">%</span> endfor
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Non-existing run context '%s' selected.&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="statement-template"><a href="#statement-template" class="header-anchor">#</a> Statement template</h3> <p>TESTed uses the statement template to convert statements and expressions to the programming language of the submission.
This is how the C language module implements the statement template:</p> <div class="language-c extra-class"><pre class="language-c"><code>## Convert a statement and<span class="token operator">/</span>or expression into Java code<span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">!</span> from tested<span class="token punctuation">.</span>utils import get_args <span class="token operator">%</span><span class="token operator">&gt;</span>\
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">!</span> from tested<span class="token punctuation">.</span>serialisation import Value<span class="token punctuation">,</span> Identifier<span class="token punctuation">,</span> FunctionCall<span class="token punctuation">,</span> Assignment <span class="token operator">%</span><span class="token operator">&gt;</span>\
<span class="token operator">&lt;</span><span class="token operator">%</span>page args<span class="token operator">=</span><span class="token string">&quot;statement,full=False&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> <span class="token keyword">if</span> <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> Identifier<span class="token punctuation">)</span><span class="token operator">:</span>
    ## If the expression is an identifier<span class="token punctuation">,</span> just echo it<span class="token punctuation">.</span>
    $<span class="token punctuation">{</span>statement<span class="token punctuation">}</span>\
<span class="token operator">%</span> elif <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> FunctionCall<span class="token punctuation">)</span><span class="token operator">:</span>
    ## Delegate to the function template <span class="token keyword">for</span> function calls<span class="token punctuation">.</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;function.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;function=statement&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> elif <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> <span class="token function">get_args</span><span class="token punctuation">(</span>Value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
    ## We have a value<span class="token punctuation">,</span> delegate to the value template<span class="token punctuation">.</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;value.mako&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token string">&quot;value=statement&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> <span class="token keyword">else</span><span class="token operator">:</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span> assert <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> <span class="token function">get_args</span><span class="token punctuation">(</span>Assignment<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>\
    <span class="token operator">%</span> <span class="token keyword">if</span> full<span class="token operator">:</span>
        <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;declaration.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;tp=statement.type, value=statement.expression&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> \
    <span class="token operator">%</span> endif
    $<span class="token punctuation">{</span>statement<span class="token punctuation">.</span>variable<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;statement.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;statement=statement.expression&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> endif
</code></pre></div><p>One non-intuitive aspect is the parameter <code>full</code> that indicates whether a variable declaration is needed:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> variabele <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// with declaration</span>
variabele <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// without declaration</span>
</code></pre></div><p>See the actual templates for examples of how to handle most language constructs.</p> <h2 id="register-the-language"><a href="#register-the-language" class="header-anchor">#</a> Register the language</h2> <p>We also need to register the language module in TESTed.
This must always be done manually, even if the generator is used to generate stubs.
In the file <code>tested/languages/__init__.py</code>, add the language to the dictionary <code>LANGUAGES</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>LANGUAGES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'c'</span><span class="token punctuation">:</span> C<span class="token punctuation">,</span>  <span class="token comment"># This is what we added here, mapping a name to the configuration class.</span>
    <span class="token string">'haskell'</span><span class="token punctuation">:</span> Haskell<span class="token punctuation">,</span>
    <span class="token string">'java'</span><span class="token punctuation">:</span> Java<span class="token punctuation">,</span>
    <span class="token string">'javascript'</span><span class="token punctuation">:</span> JavaScript<span class="token punctuation">,</span>
    <span class="token string">'kotlin'</span><span class="token punctuation">:</span> Kotlin<span class="token punctuation">,</span>
    <span class="token string">'python'</span><span class="token punctuation">:</span> Python<span class="token punctuation">,</span>
    <span class="token string">'runhaskell'</span><span class="token punctuation">:</span> RunHaskell<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="testing-the-language-implementation"><a href="#testing-the-language-implementation" class="header-anchor">#</a> Testing the language implementation</h2> <p>Now that we have configured and registered the language for TESTed,
we can test if the language implementation works as expected.
TESTed contains some predefined tests that can be used for that purpose.
Before this can be done, you should also extend the tests to support testing the new programming language:</p> <ol><li>Add solutions in the programming language to one or more of the test exercises (in the <code>exercise</code> directory). Take a look at the existing solutions to infer what your solutions should do.</li> <li>Modify <code>tests/test_functionality.py</code> and other test files to include the new programming language for testing.</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7cfd56ff.js" defer></script><script src="/assets/js/3.8e0e6159.js" defer></script><script src="/assets/js/96.3935243d.js" defer></script>
  </body>
</html>
