<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[nl] Configureren nieuwe programmeertaal TESTed | Dodona Docs</title>
    <meta name="generator" content="VuePress 1.9.5">
    <meta name="description" content="[nl] Configureren nieuwe programmeertaal TESTed">
    <meta name="theme-color" content="#1976d2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.58d1f827.css" as="style"><link rel="preload" href="/assets/js/app.0ba4e3d2.js" as="script"><link rel="preload" href="/assets/js/3.309e92ab.js" as="script"><link rel="preload" href="/assets/js/94.b2e211ad.js" as="script"><link rel="prefetch" href="/assets/js/10.0091dc36.js"><link rel="prefetch" href="/assets/js/100.ac43a220.js"><link rel="prefetch" href="/assets/js/101.742cb8f9.js"><link rel="prefetch" href="/assets/js/102.57fce6d7.js"><link rel="prefetch" href="/assets/js/103.1fa5324c.js"><link rel="prefetch" href="/assets/js/104.ee3db7ce.js"><link rel="prefetch" href="/assets/js/105.aeccd476.js"><link rel="prefetch" href="/assets/js/106.d440999b.js"><link rel="prefetch" href="/assets/js/107.d4c165ea.js"><link rel="prefetch" href="/assets/js/108.348246bc.js"><link rel="prefetch" href="/assets/js/109.627901b5.js"><link rel="prefetch" href="/assets/js/11.ada7aa0a.js"><link rel="prefetch" href="/assets/js/110.397a27a4.js"><link rel="prefetch" href="/assets/js/111.9eed091b.js"><link rel="prefetch" href="/assets/js/112.434d1dbc.js"><link rel="prefetch" href="/assets/js/113.f7940f8e.js"><link rel="prefetch" href="/assets/js/114.e9fa0067.js"><link rel="prefetch" href="/assets/js/115.b6f5e9cf.js"><link rel="prefetch" href="/assets/js/116.bcf48f0e.js"><link rel="prefetch" href="/assets/js/117.0f1b4643.js"><link rel="prefetch" href="/assets/js/118.a4329057.js"><link rel="prefetch" href="/assets/js/119.10b3d970.js"><link rel="prefetch" href="/assets/js/12.f8da6efe.js"><link rel="prefetch" href="/assets/js/13.26c3319f.js"><link rel="prefetch" href="/assets/js/14.a40e1a61.js"><link rel="prefetch" href="/assets/js/15.1393a588.js"><link rel="prefetch" href="/assets/js/16.66fa1fad.js"><link rel="prefetch" href="/assets/js/17.995be71c.js"><link rel="prefetch" href="/assets/js/18.ed3b2f35.js"><link rel="prefetch" href="/assets/js/19.72b90583.js"><link rel="prefetch" href="/assets/js/20.a03db504.js"><link rel="prefetch" href="/assets/js/21.4f8a819b.js"><link rel="prefetch" href="/assets/js/22.8e5eb64a.js"><link rel="prefetch" href="/assets/js/23.63eb24c3.js"><link rel="prefetch" href="/assets/js/24.7d30b263.js"><link rel="prefetch" href="/assets/js/25.5acbf4d0.js"><link rel="prefetch" href="/assets/js/26.d6d8401d.js"><link rel="prefetch" href="/assets/js/27.51ec61d2.js"><link rel="prefetch" href="/assets/js/28.b357da84.js"><link rel="prefetch" href="/assets/js/29.4d52ee68.js"><link rel="prefetch" href="/assets/js/30.4d327090.js"><link rel="prefetch" href="/assets/js/31.f2bea294.js"><link rel="prefetch" href="/assets/js/32.44a6f35f.js"><link rel="prefetch" href="/assets/js/33.f9bf2dbc.js"><link rel="prefetch" href="/assets/js/34.2cf1834b.js"><link rel="prefetch" href="/assets/js/35.23029536.js"><link rel="prefetch" href="/assets/js/36.1b5f6dfd.js"><link rel="prefetch" href="/assets/js/37.3fed3201.js"><link rel="prefetch" href="/assets/js/38.08761b47.js"><link rel="prefetch" href="/assets/js/39.5625dd8e.js"><link rel="prefetch" href="/assets/js/4.c31c1ab8.js"><link rel="prefetch" href="/assets/js/40.443bca30.js"><link rel="prefetch" href="/assets/js/41.e83512f0.js"><link rel="prefetch" href="/assets/js/42.39488b64.js"><link rel="prefetch" href="/assets/js/43.338f33e5.js"><link rel="prefetch" href="/assets/js/44.91c7b760.js"><link rel="prefetch" href="/assets/js/45.ac1ce27a.js"><link rel="prefetch" href="/assets/js/46.f137548a.js"><link rel="prefetch" href="/assets/js/47.45eab909.js"><link rel="prefetch" href="/assets/js/48.50e44fbd.js"><link rel="prefetch" href="/assets/js/49.391ef5e1.js"><link rel="prefetch" href="/assets/js/5.eb35b6d7.js"><link rel="prefetch" href="/assets/js/50.7ea2ee34.js"><link rel="prefetch" href="/assets/js/51.7fa89731.js"><link rel="prefetch" href="/assets/js/52.2bef0aa5.js"><link rel="prefetch" href="/assets/js/53.8793f6ad.js"><link rel="prefetch" href="/assets/js/54.600052d6.js"><link rel="prefetch" href="/assets/js/55.ce70ef05.js"><link rel="prefetch" href="/assets/js/56.390dc01b.js"><link rel="prefetch" href="/assets/js/57.0b2406b9.js"><link rel="prefetch" href="/assets/js/58.8356e5d3.js"><link rel="prefetch" href="/assets/js/59.f96fc5be.js"><link rel="prefetch" href="/assets/js/6.c4a0173f.js"><link rel="prefetch" href="/assets/js/60.7ba5aab4.js"><link rel="prefetch" href="/assets/js/61.9e9a6536.js"><link rel="prefetch" href="/assets/js/62.15c5d644.js"><link rel="prefetch" href="/assets/js/63.3528038c.js"><link rel="prefetch" href="/assets/js/64.11656b4a.js"><link rel="prefetch" href="/assets/js/65.a765ddcc.js"><link rel="prefetch" href="/assets/js/66.e5c456f3.js"><link rel="prefetch" href="/assets/js/67.f91aeac7.js"><link rel="prefetch" href="/assets/js/68.9979ea02.js"><link rel="prefetch" href="/assets/js/69.85545a5e.js"><link rel="prefetch" href="/assets/js/7.673c66a2.js"><link rel="prefetch" href="/assets/js/70.efaee7c6.js"><link rel="prefetch" href="/assets/js/71.f839ed12.js"><link rel="prefetch" href="/assets/js/72.2904f56b.js"><link rel="prefetch" href="/assets/js/73.94b8bda1.js"><link rel="prefetch" href="/assets/js/74.d307d27b.js"><link rel="prefetch" href="/assets/js/75.f1f5bcf9.js"><link rel="prefetch" href="/assets/js/76.d313c556.js"><link rel="prefetch" href="/assets/js/77.326c87f9.js"><link rel="prefetch" href="/assets/js/78.e1d8a1d2.js"><link rel="prefetch" href="/assets/js/79.63a1ba77.js"><link rel="prefetch" href="/assets/js/8.131cbdb3.js"><link rel="prefetch" href="/assets/js/80.9f638099.js"><link rel="prefetch" href="/assets/js/81.565acac5.js"><link rel="prefetch" href="/assets/js/82.65bed451.js"><link rel="prefetch" href="/assets/js/83.56b23e6c.js"><link rel="prefetch" href="/assets/js/84.dcfac4e8.js"><link rel="prefetch" href="/assets/js/85.5d5f3e85.js"><link rel="prefetch" href="/assets/js/86.408fe5a2.js"><link rel="prefetch" href="/assets/js/87.58a667c1.js"><link rel="prefetch" href="/assets/js/88.f4857995.js"><link rel="prefetch" href="/assets/js/89.bb334ce5.js"><link rel="prefetch" href="/assets/js/9.581dadd5.js"><link rel="prefetch" href="/assets/js/90.8920babc.js"><link rel="prefetch" href="/assets/js/91.a905d725.js"><link rel="prefetch" href="/assets/js/92.b366c4c1.js"><link rel="prefetch" href="/assets/js/93.09672b4a.js"><link rel="prefetch" href="/assets/js/95.bf4ea8b7.js"><link rel="prefetch" href="/assets/js/96.a6c9e298.js"><link rel="prefetch" href="/assets/js/97.8824a792.js"><link rel="prefetch" href="/assets/js/98.2791f43a.js"><link rel="prefetch" href="/assets/js/99.0ff5525b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f3f7b7f2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.58d1f827.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><!----> <span class="site-name">Dodona Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/news/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/en/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/en/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/en/tested-judge/" class="nav-link router-link-active">
  TESTed
</a></div><div class="nav-item"><a href="https://dodona.ugent.be" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dodona
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">üåê</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">üåê</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nl/tested-judge/configure-new-programming-language/" class="nav-link">
  Nederlands
</a></li><li class="dropdown-item"><!----> <a href="/en/tested-judge/configure-new-programming-language/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/news/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/en/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/en/references/" class="nav-link">
  References
</a></div><div class="nav-item"><a href="/en/tested-judge/" class="nav-link router-link-active">
  TESTed
</a></div><div class="nav-item"><a href="https://dodona.ugent.be" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dodona
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">üåê</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">üåê</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nl/tested-judge/configure-new-programming-language/" class="nav-link">
  Nederlands
</a></li><li class="dropdown-item"><!----> <a href="/en/tested-judge/configure-new-programming-language/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/en/news/" class="sidebar-link">News</a></li><li><a href="/en/guides/" class="sidebar-link">Guides</a></li><li><a href="/en/references/" class="sidebar-link">References</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TESTed judge</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/tested-judge/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/en/tested-judge/exercise-config/" class="sidebar-link">Configuration TESTed</a></li><li><a href="/en/tested-judge/dsl/" class="sidebar-link">TESTed DSL</a></li><li><a href="/en/tested-judge/json/" class="sidebar-link">TESTed JSON-testplans</a></li><li><a href="/en/tested-judge/template-description/" class="sidebar-link">TESTed description templates</a></li><li><a href="/en/tested-judge/template-exercise/" class="sidebar-link">Exercise templates for TESTed</a></li><li><a href="/en/tested-judge/standalone/" class="sidebar-link">TESTed outside Dodona</a></li><li><a href="/en/tested-judge/configure-new-programming-language/" aria-current="page" class="active sidebar-link">[nl] Configureren nieuwe programmeertaal TESTed</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#tested-lokaal-uitvoeren" class="sidebar-link">TESTed lokaal uitvoeren</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#de-broncode" class="sidebar-link">De broncode</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#dependencies" class="sidebar-link">Dependencies</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#uitvoeren" class="sidebar-link">Uitvoeren</a></li></ul></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#globaal-stappenplan-voor-het-configureren-van-een-programmeertaal" class="sidebar-link">Globaal stappenplan voor het configureren van een programmeertaal</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#de-programmeertaal-c" class="sidebar-link">De programmeertaal C</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#locatie-van-de-code" class="sidebar-link">Locatie van de code</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#configuratiebestanden" class="sidebar-link">Configuratiebestanden</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#typeconfiguratiebestand" class="sidebar-link">Typeconfiguratiebestand</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#configuratieklasse" class="sidebar-link">Configuratieklasse</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#sjablonen" class="sidebar-link">Sjablonen</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#hulpmodules" class="sidebar-link">Hulpmodules</a></li><li class="sidebar-sub-header"><a href="/en/tested-judge/configure-new-programming-language/#registratie" class="sidebar-link">Registratie</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="custom-block warning"><p class="custom-block-title">Sorry</p> <p>For now, this page is only available in Dutch. Sorry!</p></div> <h1 id="configuratie-van-een-programmeertaal"><a href="#configuratie-van-een-programmeertaal" class="header-anchor">#</a> Configuratie van een programmeertaal</h1> <p>In deze handleiding wordt in detail uitgelegd hoe een nieuwe programmeertaal aan TESTed kan toegevoegd worden.
We doen dat door te beschrijven hoe de programmeertaal C toegevoegd is.
Enkele nuttige links die hierbij kunnen helpen zijn:</p> <ul><li>Bestaande configuraties: <a href="https://github.com/dodona-edu/universal-judge/tree/master/tested/languages" target="_blank" rel="noopener noreferrer">https://github.com/dodona-edu/universal-judge/tree/master/tested/languages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Testoefeningen: <a href="https://github.com/dodona-edu/universal-judge/tree/master/exercise" target="_blank" rel="noopener noreferrer">https://github.com/dodona-edu/universal-judge/tree/master/exercise<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>In deze handleiding worden regelmatig codebestanden getoond, verspreid over meerdere codefragmenten
(bijvoorbeeld eerst <code>n</code> regels, daarna wat tekst en dan pas de rest van de regels).</p> <h2 id="tested-lokaal-uitvoeren"><a href="#tested-lokaal-uitvoeren" class="header-anchor">#</a> TESTed lokaal uitvoeren</h2> <p>Tijdens het configureren van een programmeertaal is het nuttig om TESTed lokaal uit te voeren,
zonder daarvoor het volledige Dodona-platform te moeten uitvoeren.
Buiten de <em>dependencies</em> voor de bestaande programmeertalen is TESTed een Python-package,
dat op de normale manier uitgevoerd kan worden.</p> <h3 id="de-broncode"><a href="#de-broncode" class="header-anchor">#</a> De broncode</h3> <p>Na het klonen van de repository van TESTed beschikken we over volgende mappenstructuur:</p> <div class="language-text extra-class"><pre class="language-text"><code>universal-judge
‚îú‚îÄ‚îÄ docker/ # Een Docker-image om TESTed uit te voeren.
‚îú‚îÄ‚îÄ exercise/ # De map met oefeningen die dienen als voorbeeld en voor de tests.
‚îú‚îÄ‚îÄ tested/ # Broncode van TESTed.
‚îú‚îÄ‚îÄ tests/ # Testcode van TESTed.
‚îú‚îÄ‚îÄ workdir/ # De uitvoer van TESTed bij manuele uitvoer.
‚îú‚îÄ‚îÄ config.json # Configuratiebestand voor gebruik in Dodona.
‚îî‚îÄ‚îÄ run # Wordt gebruikt door Dodona om TESTed uit te voeren.
</code></pre></div><h3 id="dependencies"><a href="#dependencies" class="header-anchor">#</a> Dependencies</h3> <p>De dependencies van TESTed zelf zijn opgelijst in een <code>requirements.txt</code>-bestand, zoals gebruikelijk is bij
Python-projecten.
Vereisten voor het uitvoeren van tests staan in <code>requirements-test.txt</code>.
TESTed gebruikt Python 3.9 of later.
Het installeren van deze vereisten gebeurt op de gebruikelijke manier:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> pip <span class="token function">install</span> -r requirements.txt
</code></pre></div><p>Voor de programmeertalen die momenteel reeds geconfigureerd zijn, zijn volgende dependencies nodig:</p> <ul><li><p><strong>Python</strong>: vereist Python 3.9.
Indien de linter gebruikt wordt, is <code>pylint</code> een dependency.
Daarnaast moet <code>python</code> beschikbaar zijn in het <code>PATH</code>.
Door optimalisaties is het momenteel aan te raden om dezelfde Python-versie te gebruiken voor TESTed als voor de
Python-oefeningen.</p></li> <li><p><strong>Java</strong>: vereist Java 11, maar heeft verder geen dependencies.
De commando's <code>javac</code> en <code>java</code> moeten beschikbaar zijn in het <code>PATH</code>.</p></li> <li><p><strong>JavaScript</strong>: vereist NodeJS v10 of later, maar heeft verder geen dependencies.
Het commando <code>node</code> moet beschikbaar zijn in het <code>PATH</code>.</p></li> <li><p><strong>Kotlin</strong>: vereist Kotlin 1.4.10, maar heeft verder geen dependencies.
De commando's <code>kotlinc</code> en <code>kotlin</code> moeten beschikbaar zijn in het <code>PATH</code>.</p></li> <li><p><strong>Haskell</strong>: Voor Haskell is GHC 8.6 (<code>ghc</code>) of later nodig.
Daarnaast is <code>aeson</code> nodig.
Beiden moeten globaal beschikbaar zijn in het <code>PATH</code>.</p></li></ul> <p>Merk op dat de dependencies voor de programmeertalen optioneel zijn.
Om bijvoorbeeld enkel Python-oplossingen te beoordelen zijn geen andere dependencies nodig.</p> <p>Voor de programmeertaal C gaan we gebruikmaken van GCC, waarbij versie 8.1 of later nodig is.</p> <p>TESTed werkt op elk besturingssysteem dat ondersteund wordt door Python.
Sommige dependencies, zoals GCC, vragen wel meer moeite om te installeren op Windows.</p> <div class="custom-block tip"><p class="custom-block-title">Windows tip</p> <p>We raden Windows 10 gebruikers aan om het <a href="https://ubuntu.com/wsl" target="_blank" rel="noopener noreferrer">Windows Subsystem for Linux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> te gebruiken.</p> <p>Wanneer dit niet mogelijk is, kunnen Windows gebruikers MingW of MSYS2 proberen.</p></div> <h3 id="uitvoeren"><a href="#uitvoeren" class="header-anchor">#</a> Uitvoeren</h3> <p>We gaan er voor de rest van de handleiding vanuit dat commando's uitgevoerd worden in de map <code>./</code>.</p> <p>Er zijn twee manieren om TESTed uit te voeren.
Ten eerste is er de &quot;gewone&quot; manier; dit is ook hoe Dodona TESTed uitvoert.
Bij het uitvoeren op deze manier zal TESTed een configuratie lezen van <code>stdin</code> en zal TESTed het resultaat van de
beoordeling in Dodona-formaat uitgeschreven worden naar <code>stdout</code>.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python -m tested
</code></pre></div><p>Bij het configureren van een programmeertaal of het werken aan TESTed is het echter nuttiger om meer uitvoer te zien en
is het vervelend om telkens een configuratie te lezen vanop <code>stdin</code>. Daarom is er een tweede manier:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python -m tested.manual
</code></pre></div><p>Deze uitvoer verschilt op een aantal vlakken van de gewone uitvoering:</p> <ol><li>Er wordt geen configuratie gelezen van <code>stdin</code>.
De configuratie is gedefinieerd in de code zelf en gebruikt een van de oefeningen die in de map <code>exercise</code> zitten.</li> <li>Er worden, naast de resultaten van de beoordeling, logs uitgeschreven naar <code>stdout</code> die aangeven wat TESTed doet.
Als er bijvoorbeeld een fout optreedt tijdens het compileren zullen deze logs nuttig zijn: zo wordt uitgeschreven
welk commando TESTed exact uitvoert voor de compilatie en ook in welke map dat gebeurt.</li> <li>De configuratie is zo opgesteld dat de werkmap van de judge de map <code>workdir</code> zal zijn. Dit laat toe om de
gegenereerde code te inspecteren.</li></ol> <h2 id="globaal-stappenplan-voor-het-configureren-van-een-programmeertaal"><a href="#globaal-stappenplan-voor-het-configureren-van-een-programmeertaal" class="header-anchor">#</a> Globaal stappenplan voor het configureren van een programmeertaal</h2> <p>Het configureren van een programmeertaal in TESTed bestaat uit drie grote onderdelen:</p> <ol><li>Het configuratiebestand, met enkele opties voor de programmeertaal.
Het typeconfiguratiebestand, met de benaming van de datatypes.</li> <li>De configuratieklasse, met de meer dynamische opties, zoals het compilatiecommando.</li> <li>De sjablonen, die gebruikt worden om code te genereren.</li></ol> <p>TESTed voorziet een hulpmiddel om de bestanden op de juiste plaats te genereren.
Op basis van enkele vragen worden <em>stubs</em> gegenereerd voor het configuratiebestand,
de configuratieklasse en de sjablonen.
Dit hulpmiddel kan als volgt uitgevoerd worden:</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span> python -m tested.generation
</code></pre></div><p>Merk op dat dit enkel bestanden genereert.
De stappen in <a href="#registratie">Registratie</a> voor het registreren van de nieuwe programmeertaal in zijn nog steeds nodig.</p> <p>We overlopen nu elk onderdeel in functie van de programmeertaal C.
We gaan er telkens vanuit dat bovenstaande hulpmiddel niet gebruikt is en dat de bestanden dus nog gemaakt moeten worden.
Is bovenstaande hulpmiddel wel gebruikt, dan kunnen de instructies voor het maken van bestanden genegeerd worden.</p> <h2 id="de-programmeertaal-c"><a href="#de-programmeertaal-c" class="header-anchor">#</a> De programmeertaal C</h2> <p>Voor we beginnen aan de configuratie, overlopen we kort welke functionaliteit we willen ondersteunen:
welke functionaliteit uit C kunnen we aanbieden in TESTed en welke functionaliteit uit TESTed kunnen we implementeren in
C?
Uiteraard willen we zoveel mogelijk ondersteunen, maar vooral op het vlak van gegevenstypes zijn er momenteel beperkingen.</p> <h5 id="welke-basistypes-gaan-we-niet-ondersteunen"><a href="#welke-basistypes-gaan-we-niet-ondersteunen" class="header-anchor">#</a> Welke basistypes gaan we niet ondersteunen?</h5> <ul><li><code>sequence</code>:
Arrays zijn een speciaal geval in C: statische arrays kunnen bijvoorbeeld niet als returnwaarde dienen, en ook als
functieargument zijn ze niet ideaal.
Dynamische arrays nemen de vorm aan van een pointer en een grootte.
TESTed heeft momenteel geen ondersteuning voor datatypes die als twee waarden ge√Ømplementeerd moeten worden,
dus worden arrays momenteel niet ondersteund.</li> <li><code>set</code>:
C heeft geen ingebouwde verzamelingen.</li> <li><code>map</code>:
C heeft geen ingebouwde map of dict.
Er zijn wel structs, maar daarvan is het niet mogelijk om de velden at runtime op te vragen,
waardoor we ze niet kunnen serialiseren.</li></ul> <h5 id="welke-geavanceerde-types-gaan-we-niet-ondersteunen"><a href="#welke-geavanceerde-types-gaan-we-niet-ondersteunen" class="header-anchor">#</a> Welke geavanceerde types gaan we niet ondersteunen?</h5> <ul><li><code>big_int</code>:
C heeft geen ingebouwd type voor getallen van arbitraire grootte.</li> <li><code>fixed_precision</code>:
C heeft geen ingebouwd type voor kommagetallen met willekeurige precisie.</li> <li><strong>Andere datastructuren</strong>:
Het gaat hier om datastructuren zoals <code>array</code> en <code>list</code> (om dezelfde redenen als hierboven).
Ook <code>tuple</code> wordt niet ondersteund, omdat het niet bestaat in C.</li></ul> <h3 id="locatie-van-de-code"><a href="#locatie-van-de-code" class="header-anchor">#</a> Locatie van de code</h3> <p>De eerste stap in het configureren van een programmeertaal is het aanmaken van een map waarin we de code voor de
programmeertaal zullen zetten.
Deze map moet de naam van de programmeertaal krijgen en op de juiste plaats binnen TESTed aanwezig zijn.
Maak een nieuwe map <code>tested/languages/c</code>.
Na het aanmaken van de map moet de mappenstructuur er zo uitzien:</p> <div class="language-text extra-class"><pre class="language-text"><code>universal-judge/
‚îú‚îÄ tested/
‚îÇ ‚îú‚îÄ languages/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ c/ &amp;lt;- nieuwe map
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ haskell/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ java/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ python/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ config.py
‚îÇ ‚îÇ ...
‚îÇ ...
...
</code></pre></div><h3 id="configuratiebestanden"><a href="#configuratiebestanden" class="header-anchor">#</a> Configuratiebestanden</h3> <p>Het configuratiebestand is een JSON-bestand met enkele eigenschappen van de programmeertaal.
Dit configuratiebestand maakt het implementeren van de configuratieklasse een stuk eenvoudiger, omdat de implementatie
van die klasse daardoor veel minder lang zal zijn.
Maak eerst het configuratiebestand aan: <code>tested/languages/c/config.json</code>.</p> <p>Merk op dat het configuratiebestand slechts een hulpmiddel is: indien gewenst kunnen al deze opties ook ingesteld worden
door de juiste methodes te implementeren in de configuratieklasse, maar we verwachten dat dit in veel gevallen niet
nodig zal zijn.</p> <h4 id="algemene-opties"><a href="#algemene-opties" class="header-anchor">#</a> Algemene opties</h4> <ul><li><code>general.dependencies</code>:
Dit zijn bestanden die beschikbaar zullen zijn tijdens het compileren en tijdens het uitvoeren van de beoordeling.
Dit betekent dat deze dependencies gebruikt kunnen worden in de testcode voor de contexten en de evaluatiecode voor de
geprogrammeerde en programmeertaalspecifieke code.
In het geval van C is dit de <code>values</code>-module, waarvan we de implementatie later bespreken.
Deze dependencies zijn bedoeld om gebruikt te worden in de code gegenereerd door de sjablonen, niet in de ingediende
oplossing (hoewel dat momenteel technisch mogelijk is).</li> <li><code>general.selector</code>:
Dit geeft aan of de programmeertaal gebruikmaakt van een selector tijdens het uitvoeren van code die gecompileerd is
in batchcompilatie.
Voor de meeste talen met compilatie zal dit <code>true</code> zijn.
Zo ook bij C.</li> <li><code>extensions.file</code>:
Geeft de voornaamste bestandsextensie aan van de bestanden.
Met voornaamste bedoelen we de extensie van de bestanden die gegenereerd worden.
Bijvoorbeeld in C bestaan zowel <code>.h</code> en <code>.c</code>, maar de gegenereerde code gebruikt <code>.c</code>.</li> <li><code>extensions.templates</code>:
- wordt gebruikt om aan te geven welke extensies gebruikt worden voor de sjablonen.
Standaard is dit de bestandsextensie van hierboven en <code>.mako</code>.
Het is vaak niet nodig om dit op te geven.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;general&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;values.h&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;values.c&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;evaluation_result.h&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;evaluation_result.c&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">&quot;extensions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;templates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mako&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="codestijl"><a href="#codestijl" class="header-anchor">#</a> Codestijl</h4> <p>Programmeertaalelementen zoals functies en namespaces worden omgezet in functie van de codestijl die gebruikelijk is in
de programmeertaal:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;naming_conventions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;namespace&quot;</span><span class="token operator">:</span> <span class="token string">&quot;snake_case&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;function&quot;</span><span class="token operator">:</span> <span class="token string">&quot;snake_case&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>De mogelijke waarden zijn:</p> <ul><li><code>snake_case</code>:
Tussen elk woord staat een underscore: <code>dit_is_een_voorbeeld</code>.</li> <li><code>camel_case</code>:
Elk woord, buiten het eerste, start met een hoofdletter: <code>ditIsEenVoorbeeld</code>.
Deze variant wordt ook wel <em>lowerCamelCase</em> genoemd.</li> <li><code>pascal_case</code>:
Elk woord, ook het eerste, start met een hoofdletter: <code>DitIsEenVoorbeeld</code>.
Deze variant wordt ook wel <em>UpperCamelCase</em> genoemd.</li></ul> <p>Standaard wordt <code>snake_case</code> gebruikt, dus bij C is het niet strikt nodig om deze optie in de configuratie op te nemen.</p> <h4 id="functionaliteit"><a href="#functionaliteit" class="header-anchor">#</a> Functionaliteit</h4> <p>De laatste twee blokken in de configuratie geven aan welke constructies en gegevenstypes de programmeertaal ondersteunt.
We hebben reeds besproken welke functionaliteit we willen ondersteunen en welke niet.
We beginnen met de taalconstructies vast te leggen:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;constructs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;objects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exceptions&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;function_calls&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;assignments&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;heterogeneous_collections&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;heterogeneous_arguments&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;evaluation&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;named_arguments&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;default_parameters&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Hier kan voor elke taalconstructie opgegeven worden of ze ondersteund wordt of niet (met een <code>boolean</code>).
Standaard wordt geen enkele taalconstructie ondersteund.
Dit zorgt ervoor dat alle ondersteunde constructies expliciet in het configuratiebestand staan en dat nieuwe
taalconstructies toegevoegd kunnen worden zonder dat bestaande configuraties van programmeertalen aangepast moeten
worden.</p> <p>De mogelijke taalconstructies zijn deze uit de enum <code>tested.features.Construct</code>.
Hieronder volgt een lijst van elke taalconstructie en een korte beschrijving:</p> <ul><li><code>objects</code>:
Objectgeori√´nteerde zaken zoals klassen.</li> <li><code>exceptions</code>:
Exceptions en uitzonderingen.</li> <li><code>function_calls</code>:
Functieoproepen.
Merk op dat constructors in het testplan een speciale soort functie zijn,
maar deze hangen af van de taalconstructie <code>objects</code>.</li> <li><code>assignments</code>:
Het toekennen van een waarde aan een variabele.
Een &quot;assignment&quot; moet ruim ge√Ønterpreteerd worden als ondersteuning voor iets dat neerkomt op een assigment.
Zo kent Haskell bijvoorbeeld geen assignments: <code>x = 5</code> definieert technisch gezien een functie met een constante
returnwaarde <code>5</code>.
Dit moet ook onder <code>assignments</code> gerekend worden.</li> <li><code>heterogeneous_collections</code>:
Hiermee bedoelen we collecties met elementen met verschillende gegevenstypes.
Dit is bijvoorbeeld geen probleem in Python (<code>[5, 52.23]</code>),
gaat al iets moeilijker in Java (<code>List&lt;Object&gt; = List.of(1, 52.23)</code>), maar zal niet lukken in Haskell.</li> <li><code>heterogeneous_arguments</code>:
Hiermee bedoelen we functieoproepen waarbij dezelfde functie meerdere keren wordt opgeroepen met argumenten met
verschillende datatypes (bijvoorbeeld eerst <code>check(True)</code> daarna <code>check('hallo')</code>).
Dit zal lukken in Python en Java, maar niet in Haskell en C.</li> <li><code>evaluation</code>:
Of een geprogrammeerde evaluatie mogelijk is in deze programmeertaal.
Dit is technisch gezien geen taalconstructie, maar dezelfde infrastructuur wordt gebruikt om dit te controleren.</li> <li><code>named_arguments</code>:
Of benoemde argumenten ondersteund worden.
Dit betekent dat de argumenten voor een functie niet enkel positioneel, maar ook op naam meegegeven kunnen worden.</li> <li><code>default_parameters</code>:
Of de programmeertaal standaardwaarden voor parameters ondersteunt, wat betekent dat ze kunnen weggelaten worden.</li></ul> <p>Dan moeten we nu de ondersteuning voor de gegevenstypes vastleggen:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;datatypes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;integer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;rational&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;char&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;boolean&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sequence&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;set&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;map&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;nothing&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;int64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;uint64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bigint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reduced&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;single_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;double_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;double_extended&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fixed_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;array&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;list&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tuple&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsupported&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Er zijn twee soorten gegevenstypes in TESTed: de basistypes en de geavanceerde types.
De basistypes zijn abstracte types voor concepten (zoals een sequentie of een geheel getal),
terwijl de geavanceerde types concreter zijn (zoals een geheel getal van 8 bits).
Een gegevenstype kan drie niveaus van ondersteuning hebben:</p> <ul><li><code>supported</code>:
volledige ondersteuning</li> <li><code>reduced</code>:
wordt ondersteund, maar wordt herleid tot een basistype
(bijvoorbeeld een <code>list</code> wordt ge√Ønterpreteerd als een <code>sequence</code>)</li> <li><code>unsupported</code>:
geen ondersteuning, dit is de standaardwaarde</li></ul> <p>Een opmerking hierbij is dat de status <code>reduced</code> voor de basistypes equivalent is aan <code>supported</code>: een basistype
reduceren tot een basistype blijft hetzelfde type.</p> <p>Het is de bedoeling dat de meeste programmeertalen voor het merendeel van de datatypes ten minste <code>reduced</code> hebben.
Toch is gekozen om <code>unsupported</code> als standaardwaarde te nemen;
dit zorgt ervoor dat de ondersteunde datatypes expliciet uitgeschreven zijn.
Dit laat ook toe om datatypes toe te voegen aan zonder bestaande configuraties van programmeertalen te moeten aanpassen.
Ter illustratie vermelden we hier voor C alle datatypes, ook de niet-ondersteunde.</p> <h4 id="restricties-verzamelingselementen-en-map-sleutels"><a href="#restricties-verzamelingselementen-en-map-sleutels" class="header-anchor">#</a> Restricties verzamelingselementen en map-sleutels</h4> <p>Sommige talen leggen restricties op met betrekking tot de datatypes voor verzamelingselementen en map-sleutels.
Hiervoor moeten er twee lijsten worden opgegeven worden: <code>restrictions.map_key</code> en <code>restrictions.set</code>.
De inhoud van de lijsten zijn de <code>supported</code> datatypes van TESTed die gebruikt kunnen worden, daarnaast kun je opgeven
of functieoproepen (<code>function_calls</code>) en variabelen (<code>identifiers</code>) gebruikt kunnen worden.
De <code>reduced</code> geavanceerde datatypes zullen afgeleid worden, als de basisdatatypes ondersteund worden.</p> <p>C ondersteunt geen collecties, dus zijn beide lijsten leeg.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;restrictions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;map_key&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;set&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="typeconfiguratiebestand"><a href="#typeconfiguratiebestand" class="header-anchor">#</a> Typeconfiguratiebestand</h3> <p>Het typeconfiguratiebestand is een JSON-bestand met de benamingen van datatypes en gebruikte conventies voor het
visualiseren van een consoleprompt.
Dit configuratiebestand wordt gebruikt om opgavesjablonen
(zie <a href="../template-description">Documentatie opgavesjablonen</a>)
te instanti√´ren voor de programmeertaal.
Maak eerst het configuratiebestand aan: <code>tested/languages/c/types.json</code>.</p> <h4 id="informatie-voor-de-consoleprompt"><a href="#informatie-voor-de-consoleprompt" class="header-anchor">#</a> Informatie voor de consoleprompt</h4> <ul><li><code>console.name</code>:
De gebruikte naam van de programmeertaal in de consoleprompt.
Bijvoorbeeld: <code>python</code> voor Python en <code>c</code> voor C.</li> <li><code>console.prompt</code>:
Het promptsymbool voor de programmeertaal.
Bijvoorbeeld: <code>&gt;&gt;&gt;</code> voor Python en <code>&gt;</code> voor C.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;console&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;prompt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&gt;&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="haakjes"><a href="#haakjes" class="header-anchor">#</a> Haakjes</h4> <p>De gebruikte haakjes voor collectiedatatypes.
Bijvoorbeeld: <code>[]</code> voor de Python-collecties, <code>&lt;&gt;</code> voor de generieke Java-objecten (behalve arrays, die <code>[]</code> gebruiken).
C in TESTed ondersteunt geen collecties, dus zullen we Java en Haskell als voorbeeld nemen.</p> <ul><li><code>brackets.open</code>: Generiek openingshaakje</li> <li><code>brackets.clase</code>: Generiek sluitingshaakje</li></ul> <blockquote><p>Voorbeeld Java lijst: <code>List&lt;?&gt;</code></p></blockquote> <ul><li><code>brackets.&lt;collection&gt;.open</code>: Specifiek openingshaakje voor de gegeven collectie</li> <li><code>brackets.&lt;collection&gt;.close</code>: Specifiek sluitingshaakje voor de gegeven collectie</li></ul> <blockquote><p>Voorbeeld Java integer array: <code>int[]</code></p> <p>Voorbeeld Haskell integer lijst: <code>[Int]</code></p></blockquote> <h4 id="datatypes"><a href="#datatypes" class="header-anchor">#</a> Datatypes</h4> <p>Naast de console-informatie en haakjes moeten ook de benaming van de ondersteunde datatypes worden opgegeven.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;integer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;int&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;rational&quot;</span><span class="token operator">:</span> <span class="token string">&quot;double&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;char&quot;</span><span class="token operator">:</span> <span class="token string">&quot;char&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;char*&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;boolean&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bool&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;nothing&quot;</span><span class="token operator">:</span> <span class="token string">&quot;void&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;int8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;signed char&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;uint8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsigned char&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;int16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;short&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;uint16&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsigned short&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;int32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;int&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;uint32&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsigned int&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;int64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;uint64&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsigned long&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;bigint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long long&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;single_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;float&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;double_precision&quot;</span><span class="token operator">:</span> <span class="token string">&quot;double&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;any&quot;</span><span class="token operator">:</span> <span class="token string">&quot;void*&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;inner&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Ondersteunde waarden:</p> <ul><li><strong>string</strong>: Naam van het TESTed-datatype in de programmeertaal.</li> <li><strong>boolean</strong>: Alleen voor collectiedatatypes waarbij de notatie van het collectietype uitsluitend met haakjes gebeurt.
<ul><li><code>true</code>: Het datatype van de gegevens in de collectie bevindt zich tussen de haakjes.
Hierbij moeten de haakjes van het collectie type expliciet worden opgeven.
Bijvoorbeeld een lijst in Haskell: <code>[Int]</code></li> <li><code>false</code>: De haakjes bevinden zich achter het datatype van de gegevens in de collectie.
Hierbij moeten de haakjes van het collectie type expliciet worden opgeven.
Bijvoorbeeld de Java-array: <code>int[]</code></li></ul></li></ul> <p><code>inner</code> is het object waarbij elk datatype, dat een andere naam moet krijgen in een collectie, moet opgegeven worden.
Dit geldt niet voor datatypes waarbij de haakjes achter het datatype geplaatst worden.
Bijvoorbeeld in Java: <code>Integer</code> in plaats van <code>int</code> voor <code>int32</code>.</p> <h4 id="ondersteuning-voor-natuurlijke-talen"><a href="#ondersteuning-voor-natuurlijke-talen" class="header-anchor">#</a> Ondersteuning voor natuurlijke talen</h4> <p>De benaming in de natuurlijke taal voor de collectiedatatypes en <code>text</code>, is afhankelijk van de programmeertaal.
Hiervoor wordt gevraagd om deze benaming op te geven in zowel het Engels als het Nederlands.
De vereiste velden zijn alle collectiedatatypes die ondersteund worden in TESTed door de programmeertaal,
alsook de benaming voor tekst.</p> <p>Bijvoorbeeld: in JavaScript spreekt men over <em>array</em> voor een <code>sequence</code>,
terwijl in Python men spreekt over een <em>lijst</em>.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;natural&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;en&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;nl&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="configuratieklasse"><a href="#configuratieklasse" class="header-anchor">#</a> Configuratieklasse</h3> <p>De configuratieklasse is de schakel tussen de generieke aspecten van TESTed en het programmeertaalafhankelijke gedrag.
Omdat TESTed in Python geschreven is, moet deze klasse ook in Python ge√Ømplementeerd worden.</p> <p>Maak een nieuw Python-bestand <code>tested/languages/c/config.py</code> aan.
Hierin moet een klasse komen die van <code>Language</code> overerft:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>Language<span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre></div><p>In de rest van deze paragraaf overlopen we de verschillende methodes die ge√Ømplementeerd moeten worden in deze klasse.
In de superklasse, <code>Language</code>, zijn de abstracte methodes voorzien van uitgebreide documentatie.</p> <h4 id="compileren-van-de-code"><a href="#compileren-van-de-code" class="header-anchor">#</a> Compileren van de code</h4> <p>Een eerste en belangrijke methode is de callback voor de compilatiestap:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">compilation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Config<span class="token punctuation">,</span> files<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> CallbackResult<span class="token punctuation">:</span>
    main_file <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    exec_file <span class="token operator">=</span> Path<span class="token punctuation">(</span>main_file<span class="token punctuation">)</span><span class="token punctuation">.</span>stem
    result <span class="token operator">=</span> executable_name<span class="token punctuation">(</span>exec_file<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;gcc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-std=c11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-Wall&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;evaluation_result.c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;values.c&quot;</span><span class="token punctuation">,</span>
             main_file<span class="token punctuation">,</span> <span class="token string">&quot;-o&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>De eerste parameter van deze methode is een klasse met enkele configuratie-opties, zoals de tijdslimiet, geheugenlimiet
en de programmeertaalspecifieke opties.
Dit zou bijvoorbeeld gebruikt kunnen worden om de versie van C mee te geven (zoals C11 of C99).
Dit wordt momenteel niet gedaan in C, want TESTed vereist C11, maar de mogelijkheid bestaat.
Wel moeten we opmerken dat de tijdslimiet zelden nuttig zal zijn, daar TESTed de uitvoeringstijd bijhoudt.
In de configuratieklasse is het dus niet nodig om daar rekening mee te houden.</p> <p>De andere parameter van deze methode is een lijst van bestanden waarvan TESTed vermoedt dat ze nuttig kunnen zijn voor
de compilatiestap.
Het bevat onder andere de dependencies uit het configuratiebestand,
de ingediende oplossing en de uit de sjablonen gegenereerde bestanden.
Die laatste bestanden zijn bijvoorbeeld de verschillende contexten bij een batchcompilatie,
maar kunnen ook de evaluator zijn bij een geprogrammeerde evaluatie.
De bestanden bestaan uit de naam en een bestandsextensie.</p> <p>De conventie is om het bestand met de main-functie als laatste te plaatsen.</p> <p>Al deze bestanden zullen zich in de map bevinden waarin de compilatie plaatsvindt.
Het is niet verplicht om al deze bestanden ook effectief te gebruiken:
sommige programmeertalen hebben zelf een detectiesysteem voor bestanden.
Zo is het in C voldoende om enkel het laatste bestand met de main-functie te gebruiken:
alle andere bestanden worden gevonden door GCC.</p> <p>Concreet ziet een argument voor deze parameter er bijvoorbeeld als volgt uit:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">[</span><span class="token string">'values.py'</span><span class="token punctuation">,</span> <span class="token string">'evaluation_utils.py'</span><span class="token punctuation">,</span> <span class="token string">'context_0_0.py'</span><span class="token punctuation">]</span>
</code></pre></div><p>Als returnwaarde moet deze methode een tuple met twee element teruggeven:
het compilatiecommando en een lijst van resulterende bestanden of een filter.</p> <p>Het compilatiecommando neemt de vorm aan van een lijst van de elementen waaruit het commando bestaat.
Bij het uitvoeren van dit commando zal deze lijst aan de Python-module <code>subprocess</code> gegeven worden.</p> <p>Na het uitvoeren van het compilatiecommando moet TESTed weten welke bestanden relevant zijn om mee te nemen naar een
volgende stap in de beoordeling.
Daarom moet een lijst van resulterende bestanden teruggegeven worden.
Enkel bestanden in deze lijst zullen bijvoorbeeld beschikbaar zijn bij het uitvoeren van de runs.
Een lijst van bestanden teruggeven is mogelijk indien op voorhand geweten is in welke bestanden de compilatie
resulteert.
Dit is bijvoorbeeld hier het geval (in C resulteert de compilatie in √©√©n uitvoerbaar bestand), of ook bij Python,
waar de compilatie voor elk <code>.py</code>-bestand resulteert in een <code>.pyc</code>-bestand.
Ook hier moet de conventie gerespecteerd worden dat het bestand met de <code>main</code>-functie als laatste komt.</p> <p>Het is echter niet altijd mogelijk om op voorhand te weten in welke bestanden de code zal resulteren.
Zo resulteert compilatie van √©√©n <code>.java</code>-bestand mogelijk in meerdere <code>.class</code>-bestanden,
afhankelijk van de inhoud van de bestanden.
Om dit op te lossen kan in plaats van een lijst ook een filterfunctie teruggegeven worden.</p> <p>Nadat de compilatie uitgevoerd is,
zal TESTed deze filter toepassen op elk bestand in de map waarin de compilatie uitgevoerd is.
De filterfunctie krijgt als argument de naam van een bestand en moet <code>True</code> of <code>False</code> teruggeven als het bestand
respectievelijk wel of niet moet meegenomen worden naar een volgende stap.</p> <p>Een voorbeeld van de in- en uitvoer van de compilatiemethode:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> compilation<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'submission.c'</span><span class="token punctuation">,</span> <span class="token string">'evaluation_result.c'</span><span class="token punctuation">,</span> <span class="token string">'context_0_0.c'</span><span class="token punctuation">,</span> <span class="token string">'selector.c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">'gcc'</span><span class="token punctuation">,</span> <span class="token string">'-std=c11'</span><span class="token punctuation">,</span> <span class="token string">'-Wall'</span><span class="token punctuation">,</span> <span class="token string">'evaluation_result.c'</span><span class="token punctuation">,</span> <span class="token string">'values.c'</span><span class="token punctuation">,</span> <span class="token string">'selector.c'</span><span class="token punctuation">,</span>
     <span class="token string">'-o'</span><span class="token punctuation">,</span> <span class="token string">'selector.exe'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'selector.exe'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Als een leeg compilatiecommando wordt teruggegeven, dan wordt er geen compilatie gedaan.
Dit is ook de standaardimplementatie van deze methode.
Voor programmeertalen waar geen compilatie nodig is, moet deze methode niet ge√Ømplementeerd worden.</p> <h4 id="uitvoeren-van-de-testcode"><a href="#uitvoeren-van-de-testcode" class="header-anchor">#</a> Uitvoeren van de testcode</h4> <p>Na het compileren moeten we een methode implementeren om de gecompileerde code uit te voeren:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">execution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> config<span class="token punctuation">:</span> Config<span class="token punctuation">,</span>
              cwd<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> arguments<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Command<span class="token punctuation">:</span>
    local_file <span class="token operator">=</span> cwd <span class="token operator">/</span> executable_name<span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">.</span>stem<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>local_file<span class="token punctuation">.</span>absolute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span>arguments<span class="token punctuation">]</span>
</code></pre></div><p>Deze functie heeft vier parameters:</p> <ul><li><code>config</code>:
Dezelfde configuratie-opties als bij de compilatiemethode.
Bij Java wordt dit bijvoorbeeld gebruikt om de geheugenlimiet van de JVM juist in te stellen.</li> <li><code>cwd</code>:
de map waarin het uitvoeren plaatsvindt</li> <li><code>file</code>:
het uitvoerbaar bestand dat moet uitgevoerd worden</li> <li><code>arguments</code>:
argumenten die aan het proces moeten meegegeven worden</li></ul> <p>Als resultaat moet het commando teruggegeven worden, dat ook aan <code>subprocess</code> doorgegeven wordt.</p> <p>In het geval van C is dit commando eenvoudig:
we geven het absolute pad naar het uitvoerbare bestand mee en geven ook de argumenten mee.
Het absolute pad is nodig omdat de executable die we willen uitvoeren
(en gemaakt hebben in de compilatiestap) niet in het <code>PATH</code> zit.</p> <p>Een voorbeeld van deze functie in werking is:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> execution<span class="token punctuation">(</span><span class="token string">'/test/path'</span><span class="token punctuation">,</span> <span class="token string">'executable.exe'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'/test/path/executable.exe'</span><span class="token punctuation">,</span> <span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span>
</code></pre></div><p>De basisimplementatie van de configuratie is nu klaar.
Voor de meeste programmeertalen kan nu overgegaan worden naar de sjablonen,
maar in C moeten we nog een extra methode implementeren.</p> <h4 id="aanpassen-van-de-ingediende-oplossing"><a href="#aanpassen-van-de-ingediende-oplossing" class="header-anchor">#</a> Aanpassen van de ingediende oplossing</h4> <p>De testcode die door TESTed gegenereerd wordt, kan meerdere <code>main</code>-functies bevatten:</p> <ul><li>De ingediende oplossing kan een <code>main</code>-functie hebben.</li> <li>Zowel de contexten als de selector kunnen <code>main</code>-functies hebben.</li></ul> <p>In C kan er slechts √©√©n <code>main</code>-functie per compilatie zijn.</p> <p>Een ander probleem is dat de selector elke run insluit (zoals we later zullen zien bij de sjablonen),
en elke run ook de oplossing insluit.</p> <p>Om deze redenen moeten we de code van de ingediende oplossing een beetje aanpassen:</p> <ul><li>We voegen een <code>guard</code> toe, zodat de oplossing slechts eenmaal geladen wordt.</li> <li>We hernoemen de <code>main</code>-functie naar <code>solution_main</code> indien die bestaat.
Als de <code>main</code>-functie geen argumenten had dan voegen we die ook toe.</li></ul> <p>Vertaald naar de configuratieklasse wordt dit:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">solution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> solution<span class="token punctuation">:</span> Path<span class="token punctuation">,</span> bundle<span class="token punctuation">:</span> Bundle<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>solution<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        contents <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># We use regex to find the main function.</span>
    <span class="token comment"># First, check if we have a no-arg main function.</span>
    <span class="token comment"># If so, replace it with a renamed main function that does have args.</span>
    no_args <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&quot;(int|void)(\s+)main(\s*)\((\s*)\)(\s*{)&quot;</span><span class="token punctuation">)</span>
    replacement <span class="token operator">=</span> <span class="token string">r&quot;int\2solution_main\3(\4int argc, char** argv)\5&quot;</span>
    contents<span class="token punctuation">,</span> nr <span class="token operator">=</span> re<span class="token punctuation">.</span>subn<span class="token punctuation">(</span>no_args<span class="token punctuation">,</span> replacement<span class="token punctuation">,</span> contents<span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> nr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment"># There was no main function without arguments. Now we try a main</span>
        <span class="token comment"># function with arguments.</span>
        with_args <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&quot;(int|void)(\s+)main(\s*)\((\s*)int&quot;</span><span class="token punctuation">)</span>
        replacement <span class="token operator">=</span> <span class="token string">r&quot;int\2solution_main\3(\4int&quot;</span>
        contents <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>with_args<span class="token punctuation">,</span> replacement<span class="token punctuation">,</span> contents<span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>solution<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        header <span class="token operator">=</span> <span class="token string">&quot;#pragma once\n\n&quot;</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>header <span class="token operator">+</span> contents<span class="token punctuation">)</span>
</code></pre></div><h3 id="sjablonen"><a href="#sjablonen" class="header-anchor">#</a> Sjablonen</h3> <p>De derde stap bestaat uit het schrijven van de sjablonen.
We hebben uiteraard de verplichte sjablonen nodig,
maar om code te hergebruiken kiezen we ervoor om enkele bijkomende sjablonen te schrijven:</p> <ul><li><code>run.c</code>: het sjabloon voor run (<strong>verplicht</strong>)</li> <li><code>selector.c</code>: het sjabloon voor de selector voor batchcompilatie (<strong>verplicht</strong> bij batchcompilatie)</li> <li><code>declaration.mako</code>: vertaalt de declaratie van een variabele naar code</li> <li><code>function.mako</code>: vertaalt een functieoproep naar code</li> <li><code>statement.mako</code>: vertaalt een statement of een expressie naar code (<strong>verplicht</strong>)</li> <li><code>value.mako</code>: vertaalt een letterlijke waarde naar code</li> <li><code>value_arguments.mako</code>:
hulpsjabloon voor <code>value.mako</code> (opsomming van recursieve gegevenstypes, zoals lijsten, maar ook van functieargumenten)</li> <li><code>value_basic.mako</code>: hulpsjabloon voor <code>value.mako</code> (vertaalt de basistypes)</li></ul> <p>Al deze sjablonen komen in de map <code>tested/languages/c/templates</code>.</p> <p>Het is vrij om de bestandsextensie van de sjablonen te kiezen, zolang het een extensie is uit de configuratie.
Standaard zijn de toegelaten extensies <code>.mako</code> en een programmeertaalafhankelijke extensie, hier <code>.c</code>.
Een conventie die gebruikt wordt binnen TESTed, is de volgende:</p> <ul><li><p>Sjablonen eindigen op de programmeertaalafhankelijke extensie (<code>.c</code>)
indien het sjabloon resulteert in een op zichzelf staand bestand.
Voorbeelden zijn het runsjabloon en de selector.</p></li> <li><p>Sjablonen die resulteren in een codefragment en dus vooral gebruikt worden als onderdeel van andere sjablonen eindigen
op <code>.mako</code>.
Dit zijn bijvoorbeeld de sjablonen om functies en statements om te zetten.</p></li></ul> <p>Dit wordt niet afgedwongen door TESTed; alle sjablonen hadden de extensie <code>.c</code> of <code>.mako</code> kunnen krijgen,
of een mengeling.
Dit geldt voornamelijk voor de verplichte sjablonen.
De andere sjablonen (die als hulpmiddel gebruikt worden door de verplichte sjablonen) kunnen eender welke
extensie krijgen, want bij het gebruiken van een sjabloon in Mako moet de bestandsextensie opgegeven worden.</p> <h4 id="het-runsjabloon"><a href="#het-runsjabloon" class="header-anchor">#</a> Het runsjabloon</h4> <p>Dit is veruit het grootste en het meest ingewikkelde sjabloon.
Het is verantwoordelijk voor het genereren van de testcode voor √©√©n run.</p> <p>We importeren de values-module (hierover later meer) en de ingediende oplossing.
De variabele <code>submission_name</code> zal de naam van het oplossingsbestand bevatten.
Een overzicht van alle beschikbare variabelen in het runsjabloon is te vinden in de klasse
<code>_ExecutionArguments</code> uit de module <code>tested.languages.generator</code>.</p> <p>We importeren ook alle programmeertaalspecifieke evaluatoren die we nodig zullen hebben.
De variabele <code>evaluator_names</code> bevat een verzameling van deze namen.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;values.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${submission_name}.c&quot;</span></span>
<span class="token operator">%</span> <span class="token keyword">for</span> name in evaluator_names<span class="token operator">:</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${name}.c&quot;</span></span>
<span class="token operator">%</span> endfor
</code></pre></div><h5 id="witruimte-in-mako"><a href="#witruimte-in-mako" class="header-anchor">#</a> Witruimte in Mako</h5> <p>Nuttig om weten is dat TESTed een extensie heeft toegevoegd aan Mako,
waardoor de inspringing van Mako-gerelateerde taalconstructies zal verdwijnen
(de inspringing van de <code>for</code> wordt dus verwijderd).
De <code>for</code>-loop in het fragment hierboven resulteert bijvoorbeeld in deze code:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;context_0_0.c&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;context_0_1.c&quot;</span></span>
</code></pre></div><h5 id="regeleindes-in-mako"><a href="#regeleindes-in-mako" class="header-anchor">#</a> Regeleindes in Mako</h5> <p>Ook nuttig om weten is dat een regeleinde in een sjabloon in Mako resulteert in een regeleinde in het
geproduceerde bestand.
Mako voorziet hier een oplossing voor:
door een <em>backslash</em> op het einde van de regel te plaatsen zal er geen regeleinde komen in het geproduceerde bestand.
Volgende codefragment (let op de <code>\</code>):</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> test <span class="token operator">=</span> \‚èé
<span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>‚èé
</code></pre></div><p>Zal bijvoorbeeld resulteren in deze code:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> test <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>‚èé
</code></pre></div><p>Vervolgens maken we twee variabelen aan waarin de bestanden komen die dienst doen als return- en exception-channel.
We noemen deze bestanden de uitvoerbestanden.
Merk op dat C geen exceptions ondersteunt, maar TESTed verwacht toch een bestand voor het exception-channel.
Anders zal TESTed ervan uitgaan dat er iets verkeerd liep tijdens het uitvoeren.
We defini√´ren direct ook een functie om de separator naar alle uitvoerkanalen te schrijven.</p> <p>In onderstaand codefragment en in de rest van het runsjabloon wordt regelmatig de naam van de context als prefix
gebruikt voor functies en variabelen.
Dit is omdat het in C niet mogelijk is om in meerdere bestanden functies met dezelfde naam te hebben.
Als we dus meerdere runs samen compileren en elke run heeft zijn eigen <code>write_separator</code>-functies,
dan zou het compileren mislukken.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">static</span> FILE<span class="token operator">*</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> FILE<span class="token operator">*</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;--${secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;--${context_secret_id}-- SEP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Als een resultaat geproduceerd wordt voor de return- of exception-channel,
dan moet dat resultaat geserialiseerd worden en naar de uitvoerbestanden geschreven worden.
TESTed verwacht dat volgende functies beschikbaar zijn:</p> <ul><li><code>send_value(value)</code> schrijf een waarde naar een bestand.</li> <li><code>send_exception(exception)</code> schrijf een exception naar een bestand.</li> <li><code>send_specific_value(value)</code> schrijf het resultaat van een programmeertaalspecifieke evaluatie naar de return-channel.</li> <li><code>send_specific_exception(exception)</code> schrijf het resultaat van een programmeertaalspecifieke evaluatie naar de
exception-channel.</li></ul> <p>Bij het implementeren moeten de conventies voor naamgeving van de programmeertaal toegepast worden
zo zal TESTed in Java een oproep naar een functie met naam <code>sendValue</code> genereren.</p> <p>We zullen later zien dat we zelf de oproepen naar deze functies in het sjabloon schrijven.
Toegepast op C zijn er wat wijzigingen, omdat C geen exceptions ondersteunt.
Als gevolg daarvan zullen we de exception-functies niet implementeren en zullen we ook geen oproep naar deze functies
genereren.
In C gebruiken we ook een macro in plaats van een functie: dit opnieuw omdat we niet dezelfde functie in meerdere
bestanden kunnen defini√´ren.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">send_value</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">send_value</span><span class="token expression"><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token function">write_value</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">send_specific_value</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">send_specific_value</span><span class="token expression"><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token function">write_evaluated</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span></span>
</code></pre></div><p>We zien ook dat de implementatie eenvoudig is: we geven de gekregen waarde of exception door aan de juiste functie uit
de <code>values</code>-module en geven ook het bestand mee waarin de waarde of exception moet komen.</p> <p>Waarom is het nodig is om deze functies te gebruiken?
Als TESTed een functieoproep naar deze functies kan defini√´ren,
waarom kan TESTed dan niet direct de <code>values</code>-module gebruiken, zonder daar deze functies tussen te plaatsen?</p> <p>Het antwoord is dat de <code>values</code>-module niet verplicht is.
Dit is een conventie die in alle ondersteunde programmeertalen gebruikt wordt,
maar het is evengoed mogelijk om bij de implementatie van bijvoorbeeld <code>send_value</code> de waarde rechtstreeks naar het
bestand te schrijven.
Deze functies moeten beschouwd worden als de &quot;interface&quot; tussen TESTed en de programmeertaal:
TESTed verwacht dat deze functies bestaan en de waarde of exception naar het juiste bestand schrijven,
maar hoe dat gebeurt maakt voor TESTed niet uit.</p> <p>Nu zijn we aangekomen bij het uitvoeren van de contexten zelf.
Hiervoor wordt er per context een functie gegenereerd.
Deze print eerst de <code>before</code>-code.
De <code>before</code>-code is een fragment code dat uitgevoerd wordt voor het uitvoeren van de context.
Deze kan opgegeven worden in het testplan.</p> <p>Verder schrijven we de <em>separator</em> naar de uitvoerbestanden door gebruik te maken van de functie die we eerder
gedefinieerd hebben in ons sjabloon.
Zoals we reeds bespraken, komt de uitvoer van de return- en exception-channel van alle testgevallen in dezelfde
bestanden terecht.
Het is nodig om de waarden van elkaar te kunnen onderscheiden, om goed te weten waar de resultaten van een testgeval
stoppen en waar de resultaten van het volgende testgeval beginnen.
Hiervoor gebruiken we de <em>separator</em>.</p> <p>Het is belangrijk om de separator altijd v√≥√≥r aanvang van een testgeval naar de uitvoerbestanden te schrijven.
TESTed is daar zo op voorzien: de separator na het testgeval uitschrijven zal tot verkeerde resultaten leiden.</p> <p>We genereren de code voor alle normale testgevallen.
Omdat C geen exceptions ondersteunt, is deze implementatie eenvoudig:
we schrijven de separator naar de uitvoerbestanden en voeren het invoerstatement uit.</p> <p>Dat invoerstatement is <code>testcase.input_statement()</code>, wat een geserialiseerd statement zal teruggeven.
Wat dat statement juist is, is eigenlijk niet relevant voor het sjabloon, maar het kan toch geen kwaad om het te weten:</p> <ul><li>Als de invoer van het testgeval een assignment is, zal dit resulteren in code die er zo uitziet:
<code>int variable = functieoproep();</code></li> <li>Is de invoer een uitdrukking () en zijn we ge√Ønteresseerd in de returnwaarde (het is dus niet van het type <code>void</code>),
dan zal de gegenereerde code er als volgt uitzien: <code>send_value(functieoproep());</code></li></ul> <p>Als afsluiter zetten we de <code>after</code>-code en sluiten we de bestanden. De
<code>after</code>-code is analoog aan de <code>before</code>-code.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">%</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> ctx in <span class="token function">enumerate</span><span class="token punctuation">(</span>contexts<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">void</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_context_$<span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>before<span class="token punctuation">}</span>
        <span class="token operator">%</span> <span class="token keyword">for</span> testcase in ctx<span class="token punctuation">.</span>testcases<span class="token operator">:</span>
            $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;statement.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;statement=testcase.input_statement()&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
        <span class="token operator">%</span> endfor
        $<span class="token punctuation">{</span>ctx<span class="token punctuation">.</span>after<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">%</span> endfor
</code></pre></div><p>Nu zijn we aangekomen bij het uitvoeren van de run zelf.
In C gebeurt dit in een functie die de naam van de run (<code>execution_name</code>) krijgt.
Als eerste stap maken we de bestanden voor de return- en exception-channel aan.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;${value_file}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;${exception_file}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Verder schrijven we de <em>context_separator</em> naar de uitvoerbestanden door gebruik te maken van de functie die we eerder
gedefinieerd hebben in ons sjabloon.
Zoals we reeds bespraken, komt de uitvoer van de return- en exception-channel van alle contexten in dezelfde
bestanden terecht.
Het is nodig om de waarden van elkaar te kunnen onderscheiden, om goed te weten waar de resultaten van een context
stoppen en waar de resultaten van het volgende context beginnen.
Hiervoor gebruiken we de <em>context_separator</em>.</p> <p>Het is belangrijk om de separator altijd v√≥√≥r aanvang van een context naar de uitvoerbestanden te schrijven.
TESTed is daar zo op voorzien: de separator na het context uitschrijven zal tot verkeerde resultaten leiden.</p> <p>We roepen eerst de <code>main</code>-functie van de oplossing op indien het testplan dat vereist.
Oefeningen waar geen <code>main</code>-functie opgeroepen wordt zijn bijvoorbeeld deze waarbij de student een functie moet
implementeren.</p> <p>In het codefragment hieronder wordt een oproep gedaan naar de functie <code>solution_main</code> uit de ingediende oplossing.
Deze functie hebben we zelf gemaakt door de gewone <code>main</code>-functie te hernoemen
(zie <a href="#configuratieklasse">Configuratieklasse</a>).
Als de ingediende oplossing geen <code>main</code>-functie bevatte, maar het testplan verwachtte die wel,
dan zal de compilatie falen.</p> <div class="language-c extra-class"><pre class="language-c"><code>    $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span> <span class="token keyword">if</span> run_testcase<span class="token punctuation">.</span>exists<span class="token operator">:</span>
        <span class="token keyword">char</span><span class="token operator">*</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\
        <span class="token operator">%</span> <span class="token keyword">for</span> argument in <span class="token punctuation">[</span><span class="token string">&quot;solution&quot;</span><span class="token punctuation">]</span> <span class="token operator">+</span> run_testcase<span class="token punctuation">.</span>arguments<span class="token operator">:</span>
            <span class="token string">&quot;${argument}&quot;</span><span class="token punctuation">,</span> \
        <span class="token operator">%</span> endfor
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> exit_code <span class="token operator">=</span> <span class="token function">solution_main</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span><span class="token function">len</span><span class="token punctuation">(</span>run_testcase<span class="token punctuation">.</span>arguments<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>exit_code <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> exit_code<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token operator">%</span> endif
</code></pre></div><p>Vervolgens genereren we de code die nodig is om de verschillende context uit te voeren.</p> <div class="language-c extra-class"><pre class="language-c"><code>    <span class="token operator">%</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> ctx in <span class="token function">enumerate</span><span class="token punctuation">(</span>contexts<span class="token punctuation">)</span><span class="token operator">:</span>
        $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token function">_write_context_separator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_context_$<span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span> endfor
    <span class="token function">fclose</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_value_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span>_exception_file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Omdat zowel runcompilatie als batchcompilatie ondersteunt wordt, moet elke run een <code>main</code>-functie hebben.
C laat slechts 1 <code>main</code>-functie toe.
Indien we in batchcompilatie zitten, zal de selector gebruikt worden, en zal <code>INCLUDED</code> op <code>TRUE</code> staan.
In dat geval voegen we geen <code>main</code>-functie toe.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">INCLUDED</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> $<span class="token punctuation">{</span>execution_name<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre></div><h4 id="het-selectorsjabloon"><a href="#het-selectorsjabloon" class="header-anchor">#</a> Het selectorsjabloon</h4> <p>Het is nuttig om er meteen het selectorsjabloon bij te halen: dit wordt gebruikt als TESTed in batchcompilatie werkt en
is verantwoordelijk om de juiste context uit te voeren op basis van een argument.
Het is in dit sjabloon dat de macro <code>INCLUDED</code> op <code>true</code> gezet wordt,
waardoor de <code>main</code>-functies in andere contexten niet gebruikt worden.</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INCLUDED</span> <span class="token expression">true</span></span>
<span class="token operator">%</span> <span class="token keyword">for</span> cont in contexts<span class="token operator">:</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;${cont}.c&quot;</span></span>
<span class="token operator">%</span> endfor
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;No run context selected.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">%</span> <span class="token keyword">for</span> cont in contexts<span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token string">&quot;${cont}&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> $<span class="token punctuation">{</span>cont<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token operator">%</span> endfor
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;Non-existing run context '%s' selected.&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="het-statementsjabloon"><a href="#het-statementsjabloon" class="header-anchor">#</a> Het statementsjabloon</h4> <p>Dit sjabloon wordt door TESTed gebruikt om statements te vertalen naar code.
Dit omvat onder andere assignments, functieoproepen en waarden:</p> <div class="language-c extra-class"><pre class="language-c"><code>## Convert a statement and<span class="token operator">/</span>or expression into Java code<span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">!</span> from tested<span class="token punctuation">.</span>utils import get_args <span class="token operator">%</span><span class="token operator">&gt;</span>\
<span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">!</span> from tested<span class="token punctuation">.</span>serialisation import Value<span class="token punctuation">,</span> Identifier<span class="token punctuation">,</span> FunctionCall<span class="token punctuation">,</span> Assignment <span class="token operator">%</span><span class="token operator">&gt;</span>\
<span class="token operator">&lt;</span><span class="token operator">%</span>page args<span class="token operator">=</span><span class="token string">&quot;statement,full=False&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> <span class="token keyword">if</span> <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> Identifier<span class="token punctuation">)</span><span class="token operator">:</span>
    ## If the expression is an identifier<span class="token punctuation">,</span> just echo it<span class="token punctuation">.</span>
    $<span class="token punctuation">{</span>statement<span class="token punctuation">}</span>\
<span class="token operator">%</span> elif <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> FunctionCall<span class="token punctuation">)</span><span class="token operator">:</span>
    ## Delegate to the function template <span class="token keyword">for</span> function calls<span class="token punctuation">.</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;function.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;function=statement&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> elif <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> <span class="token function">get_args</span><span class="token punctuation">(</span>Value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
    ## We have a value<span class="token punctuation">,</span> delegate to the value template<span class="token punctuation">.</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;value.mako&quot;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token string">&quot;value=statement&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> <span class="token keyword">else</span><span class="token operator">:</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span> assert <span class="token function">isinstance</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> <span class="token function">get_args</span><span class="token punctuation">(</span>Assignment<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token operator">&gt;</span>\
    <span class="token operator">%</span> <span class="token keyword">if</span> full<span class="token operator">:</span>
        <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;declaration.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;tp=statement.type, value=statement.expression&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> \
    <span class="token operator">%</span> endif
    $<span class="token punctuation">{</span>statement<span class="token punctuation">.</span>variable<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">%</span>include file<span class="token operator">=</span><span class="token string">&quot;statement.mako&quot;</span> args<span class="token operator">=</span><span class="token string">&quot;statement=statement.expression&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\
<span class="token operator">%</span> endif
</code></pre></div><p>De implementatie van dit sjabloon komt conceptueel neer op een grote <code>switch</code>,
waarbij we delegeren naar het juiste sjabloon op basis van welk soort statement of expressie het is.</p> <p>Een aspect dat wat meer uitleg vraagt, is de <code>full</code>-parameter.
Dit geeft aan dat het gegevenstype bij een variabele declaratie ook nodig is.
Het verschil is duidelijk met een voorbeeld:</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> variabele <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// met declaration</span>
variabele <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// zonder declaration</span>
</code></pre></div><p>In C is deze parameter minder relevant omdat de tweede variant zelden nodig is,
maar deze is vooral nodig in talen zoals Java.</p> <p>Wat ook nuttig kan zijn, is de functie <code>get_args</code>, ge√Ømporteerd uit <code>tested.utils</code>.
We willen op verschillende plaatsen in het sjabloon een andere actie doen op basis van het soort statement.
Normaliter zou een eenvoudige oproep met <code>isinstance</code> volstaan.
Nu zijn verschillende types, zoals <code>Value</code>, <code>Expression</code> en <code>Statement</code> geen echt type:
ze zijn ge√Ømplementeerd als een <code>Union</code>.
Zo luidt de definitie van <code>Expression</code> als volgt: <code>Expression = Union[Identifier, FunctionCall, Value]</code>.
<code>Union</code>-types kunnen niet gebruikt worden in <code>isinstance</code>.
De <code>get_args</code>-functie lost dit probleem op door de <code>Union</code> om te zetten naar een <code>tuple</code> van echte types.
Het is beter de functie <code>get_args</code> te veel dan te weinig te gebruiken: de functie werkt ook voor gewone types.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">,</span> Expression<span class="token punctuation">)</span>
TypeError
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">,</span> get_args<span class="token punctuation">(</span>Expression<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token boolean">False</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">,</span> get_args<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Ook gewone types</span>
<span class="token boolean">True</span>
</code></pre></div><h4 id="overige"><a href="#overige" class="header-anchor">#</a> Overige</h4> <p>De overige sjablonen vertalen elk een taalelement op een gelijkaardige wijze als het statementsjabloon.
Het gaat om volgende sjablonen:</p> <ul><li><code>declaration.mako</code></li> <li><code>function.mako</code></li> <li><code>value.mako</code></li> <li><code>value_arguments.mako</code></li> <li><code>value_basic.mako</code></li></ul> <p>We hebben ze niet opgenomen in deze handleiding, omdat ze sterk lijken op het statementsjabloon.
De implementatie van deze sjablonen is te bekijken in de repository.</p> <h3 id="hulpmodules"><a href="#hulpmodules" class="header-anchor">#</a> Hulpmodules</h3> <p>Zoals we in het begin van dit hoofdstuk vermeld hebben, zijn er twee bestanden die als &quot;dependency&quot; opgegeven zijn:
<code>values.c</code> en <code>values.h</code>.
Deze bestanden implementeren het serialiseren van data naar het serialisatieformaat en vormen samen de <code>values</code>-module.
De elementen die geserialiseerd moeten worden:</p> <ul><li>Waarden, zoals returnwaarden.</li> <li>Exceptions (niet het geval in C, want die bestaan niet in C).</li> <li>Resultaten van geprogrammeerde en programmeertaalspecifieke evaluaties.</li></ul> <p>Hier nemen we de implementatie opnieuw niet op, daar de implementatie van deze module volledig
programmeertaalafhankelijk is.
In Python is de implementatie eenvoudig door de ingebouwde module <code>json</code>,
terwijl de implementatie in C een stuk langer is.</p> <h3 id="registratie"><a href="#registratie" class="header-anchor">#</a> Registratie</h3> <p>Als laatste rest nu nog om de nieuwe programmeertaal te registreren bij TESTed.
Hiervoor volstaat het om de programmeertaal en de bijhorende configuratieklasse toe te voegen aan het bestand
<code>tested/languages/__init__.py</code>, in de dictionary <code>LANGUAGES</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code>LANGUAGES <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'c'</span><span class="token punctuation">:</span> C<span class="token punctuation">,</span>
  <span class="token string">'haskell'</span><span class="token punctuation">:</span> Haskell<span class="token punctuation">,</span>
  <span class="token string">'java'</span><span class="token punctuation">:</span> Java<span class="token punctuation">,</span>
  <span class="token string">'javascript'</span><span class="token punctuation">:</span> JavaScript<span class="token punctuation">,</span>
  <span class="token string">'kotlin'</span><span class="token punctuation">:</span> Kotlin<span class="token punctuation">,</span>
  <span class="token string">'python'</span><span class="token punctuation">:</span> Python<span class="token punctuation">,</span>
  <span class="token string">'runhaskell'</span><span class="token punctuation">:</span> RunHaskell<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Om de programmeertaal manueel te testen is volgend stappenplan aanbevolen:</p> <ol><li>Implementeer oplossingen voor een of meerdere oefeningen uit de map <code>exercises</code> in de nieuwe programmeertaal.</li> <li>Wijzig <code>tested/manual.py</code> zodat dit bestand de oefening gebruikt waarvoor een oplossing bestaat
(en stel ook de juiste programmeertaal in).</li> <li>Voer uit, zoals we in het begin van het hoofdstuk besproken hebben:<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> python -m tested.manual
</code></pre></div></li></ol> <p>TESTed heeft ook een testsuite met verschillende oefeningen en scenario's.
Om de nieuwe programmeertaal hieraan toe te voegen, moeten de juiste oplossingen ge√Ømplementeerd worden.
Hiervoor wordt best gekeken naar <code>tests/test_functionality.py</code>.
In dat bestand staan de verschillende testen.
Bij elke test staat welke oplossing gebruikt wordt; indien het niet duidelijk zou zijn wat de oplossing voor een
bepaalde test moet doen, kunnen de bestaande oplossingen in de bestaande programmeertalen een grote hulp zijn.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0ba4e3d2.js" defer></script><script src="/assets/js/3.309e92ab.js" defer></script><script src="/assets/js/94.b2e211ad.js" defer></script>
  </body>
</html>
